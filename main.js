(()=>{"use strict";function e(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var t=function(e){return console.log(e)},n={baseUrl:"https://nomoreparties.co/v1/wff-cohort-5",headers:{authorization:"f019a5da-c98f-4c6e-b4b9-d7890c838afb","Content-Type":"application/json"}},r=function(e,t,n,r,o){var c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),a=c.querySelector(".card__image"),u=c.querySelector(".card__title"),i=c.querySelector(".card__delete-button"),l=c.querySelector(".card__like-button"),s=l.closest(".card").querySelector(".card__like-amount");return e.owner&&e.owner._id===o?(i.style.display="block",i.addEventListener("click",(function(){return t(c,e._id)}))):i.style.display="none",e.likes&&e.likes.some((function(e){return e._id===o}))&&l.classList.add("card__like-button_is-active"),l.addEventListener("click",(function(){return n(l,s,e._id,o)})),a.addEventListener("click",(function(e){return r(e)})),a.src=e.link,a.alt=e.name,u.textContent=e.name,s.textContent=(e.likes?e.likes.length:0).toString(),c},o=function(r,o){(function(t,r){return fetch("".concat(n.baseUrl,"/cards/").concat(r),{method:"DELETE",headers:n.headers}).then(e)})(0,o).then((function(){return r.remove()})).catch(t)},c=function(r,o,c,a){(function(t,r,o){return fetch("".concat(n.baseUrl,"/cards/likes/").concat(r),{method:t.classList.contains("card__like-button_is-active")?"DELETE":"PUT",headers:n.headers}).then(e)})(r,c).then((function(e){o.textContent=e.likes.length.toString(),r.classList.toggle("card__like-button_is-active")})).catch(t)},a=document.querySelectorAll(".popup"),u=!1,i=function(e){e.classList.add("popup__opened"),s()},l=function(e){e&&(e.classList.remove("popup__opened"),d())},s=function(){u||(document.addEventListener("keydown",p),u=!0)},d=function(){document.removeEventListener("keydown",p),u=!1},p=function(e){if("Escape"===e.key){var t=document.querySelector(".popup__opened");l(t)}};a.forEach((function(e){e.addEventListener("click",(function(t){(t.target===e||t.target.classList.contains("popup__close"))&&l(e)}))}));var _,f=function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));o&&(t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass))},m=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));r&&(t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent="")},y=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove(n.inactiveButtonClass)):(t.setAttribute("disabled","true"),t.classList.add(n.inactiveButtonClass))},v=function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector));n.forEach((function(n){m(e,n,t)}));var r=e.querySelector(t.submitButtonSelector);y(n,r,t)},h=document.forms.namedItem("edit_profile"),S=document.forms.namedItem("new_place"),b=document.querySelector(".popup_type_avatar"),q=document.querySelector(".profile__edit-button"),E=document.querySelector(".profile__add-button"),L=document.querySelector(".popup_type_edit"),g=h.querySelector(".popup__input_type_name"),k=h.querySelector(".popup__input_type_description"),C=document.querySelector(".popup__input_type_avatar_url"),x=document.querySelector(".profile__title"),A=document.querySelector(".profile__description"),U=document.querySelector(".places__list"),T=document.querySelector(".popup_type_new-card"),w=document.querySelector(".profile__image"),B=document.querySelector(".popup_type_delete_card"),D=document.querySelector(".popup__input_type_card-name"),P=document.querySelector(".popup__input_type_url"),I=document.querySelector(".popup_type_image"),N=I.querySelector(".popup__image"),O=I.querySelector(".popup__caption"),j=document.querySelector(".profile__image");B.querySelector(".popup__button-delete"),w.addEventListener("click",(function(){i(b),v(b,z)})),q.addEventListener("click",(function(){i(L),v(h,z),H()})),E.addEventListener("click",(function(){i(T),v(S,z)}));var H=function(){g.value=x.textContent,k.value=A.textContent},J=function(e){if(e.target instanceof HTMLImageElement&&e.target.classList.contains("card__image")){var t=e.target.closest(".places__item").querySelector(".card__title").textContent;N.src=e.target.getAttribute("src"),N.alt=t,O.textContent=t,i(I)}};b.addEventListener("submit",(function(r){var o;r.preventDefault(),F(!0),(o=C.value,fetch("".concat(n.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:n.headers,body:JSON.stringify({avatar:o})}).then(e)).then((function(e){j.style.backgroundImage="url(".concat(e.avatar,")")})).then((function(){return l(b)})).catch(t).finally((function(){return F(!1)}))})),h.addEventListener("submit",(function(r){var o,c;r.preventDefault(),F(!0),(o=g.value,c=k.value,fetch("".concat(n.baseUrl,"/users/me"),{method:"PATCH",headers:n.headers,body:JSON.stringify({name:o,about:c})}).then(e)).then((function(e){x.textContent=e.name,A.textContent=e.about})).then((function(){return l(L)})).catch(t).finally((function(){return F(!1)}))})),S.addEventListener("submit",(function(a){var u,i;a.preventDefault(),F(!0),(u=D.value,i=P.value,fetch("".concat(n.baseUrl,"/cards"),{method:"POST",headers:n.headers,body:JSON.stringify({name:u,link:i,likes:0})}).then(e)).then((function(e){var t=r(e,o,c,J,_);U.prepend(t)})).then((function(){return S.reset()})).then((function(){return l(T)})).catch(t).finally((function(){return F(!1)}))}));var M,z={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},F=function(e){document.querySelectorAll(".popup__button").forEach((function(t){return t.textContent=e?"Сохранение...":"Сохранить"}))};Promise.all([fetch("".concat(n.baseUrl,"/users/me"),{headers:n.headers}).then(e),fetch("".concat(n.baseUrl,"/cards"),{headers:n.headers}).then(e)]).then((function(e){var t=e[0],n=e[1];_=t._id,x.textContent=t.name,A.textContent=t.about,j.style.backgroundImage="url(".concat(t.avatar,")"),function(e,t){e.forEach((function(e){var n=r(e,o,c,J,t);U.append(n)}))}(n,_)})).catch(t),M=z,Array.from(document.querySelectorAll(M.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);y(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?m(e,t,n):(f(e,t,t.validationMessage,n),""===t.value.trim()?f(e,t,t.dataset.error,n):t.validity.typeMismatch&&f(e,t,t.dataset.url,n))}(e,o,t),y(n,r,t)}))}))}(e,M)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c0JBR1ZiLEVBQWtCQyxFQUFXQyxFQUFlUixHQUU1Q08sRUFBVWIsU0FBUSxTQUFDSSxHQUNsQkEsRUFBYXhDLGlCQUFpQixTQUFTLFlBbEVkLFNBQzFCdUMsRUFDQUMsRUFDQUUsR0FFS0YsRUFBYVcsU0FBU0MsTUF1QjFCTCxFQUFlUixFQUFhQyxFQUFjRSxJQXRCMUNKLEVBQ0NDLEVBQ0FDLEVBQ0FBLEVBQWFzRSxrQkFDYnBFLEdBRWlDLEtBQTlCRixFQUFhK0MsTUFBTXdCLE9BQ3RCekUsRUFDQ0MsRUFDQUMsRUFDQUEsRUFBYXdFLFFBQVE1SSxNQUNyQnNFLEdBRVNGLEVBQWFXLFNBQVM4RCxjQUNoQzNFLEVBQ0NDLEVBQ0FDLEVBQ0FBLEVBQWF3RSxRQUFRRSxJQUNyQnhFLEdBTUosQ0FxQ0d5RSxDQUFtQjVFLEVBQWFDLEVBQWNFLEdBQzlDTSxFQUFrQkMsRUFBV0MsRUFBZVIsRUFDN0MsR0FDRCxHQUNELENBUUUwRSxDQUFrQjdFLEVBQWFHLEVBQ2hDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL2FwaS50cyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvY2FyZC50cyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvbW9kYWwudHMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBjaGVja1Jlc3BvbnNlPFQ+KHJlczogUmVzcG9uc2UpOiBQcm9taXNlPFQ+IHtcclxuXHRpZiAocmVzLm9rKSB7XHJcblx0XHRyZXR1cm4gcmVzLmpzb24oKVxyXG5cdH1cclxuXHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjYXRjaEVycm9yID0gKGVycm9yOiBzdHJpbmcpOiB2b2lkID0+IGNvbnNvbGUubG9nKGVycm9yKVxyXG4iLCJpbXBvcnQgeyBDb25maWcgfSBmcm9tICcuLi90eXBlcy9nbG9iYWwuZCdcclxuaW1wb3J0IHsgY2hlY2tSZXNwb25zZSB9IGZyb20gJy4vdXRpbHMnXHJcblxyXG5jb25zdCBjb25maWc6IENvbmZpZyA9IHtcclxuXHRiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtNScsXHJcblx0aGVhZGVyczoge1xyXG5cdFx0YXV0aG9yaXphdGlvbjogJ2YwMTlhNWRhLWM5OGYtNGM2ZS1iNGI5LWQ3ODkwYzgzOGFmYicsXHJcblx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VXNlckluZm8gPSAoKSA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuXHRcdGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xyXG5cdHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG5cdH0pLnRoZW4oY2hlY2tSZXNwb25zZSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXJQcm9maWxlID0gKG5hbWU6IHN0cmluZywgYWJvdXQ6IHN0cmluZykgPT4ge1xyXG5cdHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcblx0XHRtZXRob2Q6ICdQQVRDSCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuXHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuXHRcdFx0bmFtZSxcclxuXHRcdFx0YWJvdXRcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcG9zdE5ld0NhcmQgPSAobmFtZTogc3RyaW5nLCBsaW5rOiBzdHJpbmcpID0+IHtcclxuXHRyZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG5cdFx0bWV0aG9kOiAnUE9TVCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuXHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuXHRcdFx0bmFtZSxcclxuXHRcdFx0bGluayxcclxuXHRcdFx0bGlrZXM6IDBcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbGlrZUNhcmQgPSAoXHJcblx0bGlrZUJ1dHRvbjogSFRNTEVsZW1lbnQsXHJcblx0Y2FyZElkOiBzdHJpbmcsXHJcblx0dXNlcklkOiBzdHJpbmdcclxuKSA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcblx0XHRtZXRob2Q6IGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKVxyXG5cdFx0XHQ/ICdERUxFVEUnXHJcblx0XHRcdDogJ1BVVCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG5cdH0pLnRoZW4oY2hlY2tSZXNwb25zZSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmQgPSAoY2FyZEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBjYXJkSWQ6IHN0cmluZykgPT4ge1xyXG5cdHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG5cdFx0bWV0aG9kOiAnREVMRVRFJyxcclxuXHRcdGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgdXBkYXRlQXZhdGFyID0gKGF2YXRhcjogc3RyaW5nKSA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcblx0XHRtZXRob2Q6ICdQQVRDSCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuXHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuXHRcdFx0YXZhdGFyXHJcblx0XHR9KVxyXG5cdH0pLnRoZW4oY2hlY2tSZXNwb25zZSlcclxufVxyXG4iLCJpbXBvcnQgeyBkZWxldGVDYXJkLCBsaWtlQ2FyZCB9IGZyb20gJy4vYXBpJ1xyXG5pbXBvcnQgeyBjYXRjaEVycm9yIH0gZnJvbSAnLi91dGlscydcclxuaW1wb3J0IHsgQ2FyZCwgTGlrZXN9IGZyb20gJy4uL3R5cGVzL2dsb2JhbCdcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVDYXJkID0gKFxyXG5cdGNhcmQ6IENhcmQsXHJcblx0aGFuZGxlRGVsZXRlQ2FyZDogKGNhcmRFbGVtZW50OiBIVE1MRWxlbWVudCwgY2FyZElkOiBzdHJpbmcpID0+IHZvaWQsXHJcblx0aGFuZGxlTGlrZUNhcmQ6IChcclxuXHRcdGxpa2VCdXR0b246IEhUTUxFbGVtZW50LFxyXG5cdFx0bGlrZXNDb3VudEVsZW1lbnQ6IEhUTUxFbGVtZW50LFxyXG5cdFx0Y2FyZElkOiBzdHJpbmcsXHJcblx0XHRjdXJyZW50VXNlcklkOiBzdHJpbmdcclxuXHQpID0+IHZvaWQsXHJcblx0b3BlbkltYWdlTW9kYWw6IChldnQ6IE1vdXNlRXZlbnQpID0+IHZvaWQsXHJcblx0Y3VycmVudFVzZXJJZDogc3RyaW5nXHJcbik6IEhUTUxFbGVtZW50ID0+IHtcclxuXHRjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0JyNjYXJkLXRlbXBsYXRlJ1xyXG5cdCkgYXMgSFRNTFRlbXBsYXRlRWxlbWVudFxyXG5cdGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuXHRcdC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXHJcblx0XHQuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50XHJcblx0Y29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHRcdCcuY2FyZF9faW1hZ2UnXHJcblx0KSBhcyBIVE1MSW1hZ2VFbGVtZW50XHJcblx0Y29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykgYXMgSFRNTEVsZW1lbnRcclxuXHRjb25zdCBkZWxldGVCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0Jy5jYXJkX19kZWxldGUtYnV0dG9uJ1xyXG5cdCkgYXMgSFRNTEVsZW1lbnRcclxuXHRjb25zdCBsaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHRcdCcuY2FyZF9fbGlrZS1idXR0b24nXHJcblx0KSBhcyBIVE1MRWxlbWVudFxyXG5cdGNvbnN0IGxpa2VzQ291bnRFbGVtZW50ID0gbGlrZUJ1dHRvblxyXG5cdFx0LmNsb3Nlc3QoJy5jYXJkJylcclxuXHRcdC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1hbW91bnQnKSBhcyBIVE1MRWxlbWVudFxyXG5cclxuXHRpZiAoY2FyZC5vd25lciAmJiBjYXJkLm93bmVyLl9pZCA9PT0gY3VycmVudFVzZXJJZCkge1xyXG5cdFx0ZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXHJcblx0XHRkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PlxyXG5cdFx0XHRoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkLl9pZClcclxuXHRcdClcclxuXHR9IGVsc2Uge1xyXG5cdFx0ZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcclxuXHR9XHJcblxyXG5cdGNvbnN0IGlzTGlrZWRCeUN1cnJlbnRVc2VyID1cclxuXHRcdGNhcmQubGlrZXMgJiYgY2FyZC5saWtlcy5zb21lKGxpa2UgPT4gbGlrZS5faWQgPT09IGN1cnJlbnRVc2VySWQpXHJcblx0aWYgKGlzTGlrZWRCeUN1cnJlbnRVc2VyKSB7XHJcblx0XHRsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpXHJcblx0fVxyXG5cclxuXHRsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT5cclxuXHRcdGhhbmRsZUxpa2VDYXJkKGxpa2VCdXR0b24sIGxpa2VzQ291bnRFbGVtZW50LCBjYXJkLl9pZCwgY3VycmVudFVzZXJJZClcclxuXHQpXHJcblxyXG5cdGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiBvcGVuSW1hZ2VNb2RhbChldnQpKVxyXG5cclxuXHRjYXJkSW1hZ2Uuc3JjID0gY2FyZC5saW5rXHJcblx0Y2FyZEltYWdlLmFsdCA9IGNhcmQubmFtZVxyXG5cdGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGNhcmQubmFtZVxyXG5cdGxpa2VzQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gKFxyXG5cdFx0Y2FyZC5saWtlcyA/IGNhcmQubGlrZXMubGVuZ3RoIDogMFxyXG5cdCkudG9TdHJpbmcoKVxyXG5cclxuXHRyZXR1cm4gY2FyZEVsZW1lbnRcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGhhbmRsZURlbGV0ZUNhcmQgPSAoY2FyZEVsZW1lbnQ6IEhUTUxFbGVtZW50LCBjYXJkSWQ6IHN0cmluZykgPT4ge1xyXG5cdGRlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGNhcmRJZClcclxuXHRcdC50aGVuKCgpID0+IGNhcmRFbGVtZW50LnJlbW92ZSgpKVxyXG5cdFx0LmNhdGNoKGNhdGNoRXJyb3IpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBoYW5kbGVMaWtlQ2FyZCA9IChcclxuXHRsaWtlQnV0dG9uOiBIVE1MRWxlbWVudCxcclxuXHRsaWtlc0NvdW50RWxlbWVudDogSFRNTEVsZW1lbnQsXHJcblx0Y2FyZElkOiBzdHJpbmcsXHJcblx0Y3VycmVudFVzZXJJZDogc3RyaW5nXHJcbikgPT4ge1xyXG5cdGxpa2VDYXJkKGxpa2VCdXR0b24sIGNhcmRJZCwgY3VycmVudFVzZXJJZClcclxuXHRcdC50aGVuKChkYXRhOiB7IGxpa2VzOiBMaWtlc1tdIH0pID0+IHtcclxuXHRcdFx0bGlrZXNDb3VudEVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLmxpa2VzLmxlbmd0aC50b1N0cmluZygpXHJcblx0XHRcdGxpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJylcclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goY2F0Y2hFcnJvcilcclxufVxyXG4iLCJjb25zdCBtb2RhbHM6IE5vZGVMaXN0T2Y8SFRNTEVsZW1lbnQ+ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwJylcclxubGV0IGlzRXNjTGlzdGVuZXJBZGRlZDogYm9vbGVhbiA9IGZhbHNlXHJcblxyXG5leHBvcnQgY29uc3Qgb3Blbk1vZGFsID0gKG1vZGFsOiBIVE1MRWxlbWVudCkgPT4ge1xyXG5cdG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19vcGVuZWQnKVxyXG5cdGFkZEVzY0xpc3RlbmVyKClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNsb3NlTW9kYWwgPSAobW9kYWw6IEhUTUxFbGVtZW50IHwgbnVsbCkgPT4ge1xyXG5cdGlmIChtb2RhbCkge1xyXG5cdFx0bW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfX29wZW5lZCcpXHJcblx0XHRyZW1vdmVFc2NMaXN0ZW5lcigpXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBhZGRFc2NMaXN0ZW5lciA9ICgpID0+IHtcclxuXHRpZiAoIWlzRXNjTGlzdGVuZXJBZGRlZCkge1xyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGNsb3NlTW9kYWxPbkVzYylcclxuXHRcdGlzRXNjTGlzdGVuZXJBZGRlZCA9IHRydWVcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IHJlbW92ZUVzY0xpc3RlbmVyID0gKCkgPT4ge1xyXG5cdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZU1vZGFsT25Fc2MpXHJcblx0aXNFc2NMaXN0ZW5lckFkZGVkID0gZmFsc2VcclxufVxyXG5cclxuY29uc3QgY2xvc2VNb2RhbE9uRXNjID0gKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG5cdGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG5cdFx0Y29uc3Qgb3BlbmVkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX29wZW5lZCcpIGFzIEhUTUxFbGVtZW50XHJcblx0XHRjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKVxyXG5cdH1cclxufVxyXG5cclxubW9kYWxzLmZvckVhY2gobW9kYWwgPT4ge1xyXG5cdG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZ0ID0+IHtcclxuXHRcdGlmIChcclxuXHRcdFx0ZXZ0LnRhcmdldCA9PT0gbW9kYWwgfHxcclxuXHRcdFx0KGV2dC50YXJnZXQgYXMgSFRNTEVsZW1lbnQpLmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlJylcclxuXHRcdCkge1xyXG5cdFx0XHRjbG9zZU1vZGFsKG1vZGFsKVxyXG5cdFx0fVxyXG5cdH0pXHJcbn0pXHJcbiIsImltcG9ydCB7IFZhbGlkYXRpb25TZXR0aW5ncyB9IGZyb20gJy4uL3R5cGVzL2dsb2JhbC5kJ1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxFbGVtZW50LFxyXG5cdGlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudCxcclxuXHRlcnJvck1lc3NhZ2U6IHN0cmluZyxcclxuXHRzZXR0aW5nczogVmFsaWRhdGlvblNldHRpbmdzXHJcbikgPT4ge1xyXG5cdGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKVxyXG5cdGlmIChlcnJvckVsZW1lbnQpIHtcclxuXHRcdGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcylcclxuXHRcdGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZVxyXG5cdFx0ZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuZXJyb3JDbGFzcylcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKFxyXG5cdGZvcm1FbGVtZW50OiBIVE1MRWxlbWVudCxcclxuXHRpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYClcclxuXHRpZiAoZXJyb3JFbGVtZW50KSB7XHJcblx0XHRpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpXHJcblx0XHRlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5lcnJvckNsYXNzKVxyXG5cdFx0ZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJydcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChcclxuXHRmb3JtRWxlbWVudDogSFRNTEVsZW1lbnQsXHJcblx0aW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50LFxyXG5cdHNldHRpbmdzOiBWYWxpZGF0aW9uU2V0dGluZ3NcclxuKSA9PiB7XHJcblx0aWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuXHRcdHNob3dJbnB1dEVycm9yKFxyXG5cdFx0XHRmb3JtRWxlbWVudCxcclxuXHRcdFx0aW5wdXRFbGVtZW50LFxyXG5cdFx0XHRpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXHJcblx0XHRcdHNldHRpbmdzXHJcblx0XHQpXHJcblx0XHRpZiAoaW5wdXRFbGVtZW50LnZhbHVlLnRyaW0oKSA9PT0gJycpIHtcclxuXHRcdFx0c2hvd0lucHV0RXJyb3IoXHJcblx0XHRcdFx0Zm9ybUVsZW1lbnQsXHJcblx0XHRcdFx0aW5wdXRFbGVtZW50LFxyXG5cdFx0XHRcdGlucHV0RWxlbWVudC5kYXRhc2V0LmVycm9yLFxyXG5cdFx0XHRcdHNldHRpbmdzXHJcblx0XHRcdClcclxuXHRcdH0gZWxzZSBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnR5cGVNaXNtYXRjaCkge1xyXG5cdFx0XHRzaG93SW5wdXRFcnJvcihcclxuXHRcdFx0XHRmb3JtRWxlbWVudCxcclxuXHRcdFx0XHRpbnB1dEVsZW1lbnQsXHJcblx0XHRcdFx0aW5wdXRFbGVtZW50LmRhdGFzZXQudXJsLFxyXG5cdFx0XHRcdHNldHRpbmdzXHJcblx0XHRcdClcclxuXHRcdH1cclxuXHR9IGVsc2Uge1xyXG5cdFx0aGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0OiBIVE1MSW5wdXRFbGVtZW50W10pID0+IHtcclxuXHRyZXR1cm4gaW5wdXRMaXN0LnNvbWUoaW5wdXRFbGVtZW50ID0+IHtcclxuXHRcdHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXHJcblx0fSlcclxufVxyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoXHJcblx0aW5wdXRMaXN0OiBIVE1MSW5wdXRFbGVtZW50W10sXHJcblx0YnV0dG9uRWxlbWVudDogSFRNTEJ1dHRvbkVsZW1lbnQsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuXHRcdGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICd0cnVlJylcclxuXHRcdGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKVxyXG5cdH0gZWxzZSB7XHJcblx0XHRidXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKVxyXG5cdFx0YnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChcclxuXHRmb3JtRWxlbWVudDogSFRNTEVsZW1lbnQsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG5cdFx0Zm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG5cdCkgYXMgSFRNTElucHV0RWxlbWVudFtdXHJcblx0Y29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG5cdCkgYXMgSFRNTEJ1dHRvbkVsZW1lbnRcclxuXHJcblx0dG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncylcclxuXHJcblx0aW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudCkgPT4ge1xyXG5cdFx0aW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4ge1xyXG5cdFx0XHRjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpXHJcblx0XHRcdHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpXHJcblx0XHR9KVxyXG5cdH0pXHJcbn1cclxuXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoc2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xyXG5cdGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcikpXHJcblx0Zm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQ6IEhUTUxFbGVtZW50KSA9PiB7XHJcblx0XHRmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBldnQgPT4ge1xyXG5cdFx0XHRldnQucHJldmVudERlZmF1bHQoKVxyXG5cdFx0fSlcclxuXHRcdHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBzZXR0aW5ncylcclxuXHR9KVxyXG59XHJcblxyXG5jb25zdCBjbGVhclZhbGlkYXRpb24gPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxFbGVtZW50LFxyXG5cdHNldHRpbmdzOiBWYWxpZGF0aW9uU2V0dGluZ3NcclxuKSA9PiB7XHJcblx0Y29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuXHRcdGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcclxuXHQpIGFzIEhUTUxJbnB1dEVsZW1lbnRbXVxyXG5cdGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQpID0+IHtcclxuXHRcdGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHNldHRpbmdzKVxyXG5cdH0pXHJcblxyXG5cdGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0c2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuXHQpIGFzIEhUTUxCdXR0b25FbGVtZW50XHJcblx0dG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncylcclxufVxyXG5cclxuZXhwb3J0IHsgY2xlYXJWYWxpZGF0aW9uLCBlbmFibGVWYWxpZGF0aW9uIH1cclxuIiwiaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnXHJcbmltcG9ydCB7IENhcmQsIFVzZXJJbmZvVHlwZSB9IGZyb20gJy4uL3R5cGVzL2dsb2JhbC5kJ1xyXG5pbXBvcnQge1xyXG5cdGRlbGV0ZUNhcmQsXHJcblx0Z2V0SW5pdGlhbENhcmRzLFxyXG5cdGdldFVzZXJJbmZvLFxyXG5cdHBvc3ROZXdDYXJkLFxyXG5cdHVwZGF0ZUF2YXRhcixcclxuXHR1cGRhdGVVc2VyUHJvZmlsZVxyXG59IGZyb20gJy4vYXBpJ1xyXG5pbXBvcnQgeyBjcmVhdGVDYXJkLCBoYW5kbGVEZWxldGVDYXJkLCBoYW5kbGVMaWtlQ2FyZCB9IGZyb20gJy4vY2FyZCdcclxuaW1wb3J0IHsgY2xvc2VNb2RhbCwgb3Blbk1vZGFsIH0gZnJvbSAnLi9tb2RhbCdcclxuaW1wb3J0IHsgY2F0Y2hFcnJvciB9IGZyb20gJy4vdXRpbHMnXHJcbmltcG9ydCB7IGNsZWFyVmFsaWRhdGlvbiwgZW5hYmxlVmFsaWRhdGlvbiB9IGZyb20gJy4vdmFsaWRhdGlvbidcclxuXHJcbmNvbnN0IGVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXMubmFtZWRJdGVtKCdlZGl0X3Byb2ZpbGUnKSBhcyBIVE1MRm9ybUVsZW1lbnRcclxuY29uc3QgbmV3UGxhY2VGb3JtOiBIVE1MRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtcy5uYW1lZEl0ZW0oXHJcblx0J25ld19wbGFjZSdcclxuKSBhcyBIVE1MRm9ybUVsZW1lbnRcclxuY29uc3QgZWRpdEF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucG9wdXBfdHlwZV9hdmF0YXInXHJcbikgYXMgSFRNTEZvcm1FbGVtZW50XHJcbmNvbnN0IGVkaXRCdXR0b246IEhUTUxCdXR0b25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnByb2ZpbGVfX2VkaXQtYnV0dG9uJ1xyXG4pXHJcbmNvbnN0IGFkZEJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucHJvZmlsZV9fYWRkLWJ1dHRvbidcclxuKVxyXG5jb25zdCBtb2RhbEVkaXQ6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpXHJcbmNvbnN0IG5hbWVJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IGVkaXRGb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcblx0Jy5wb3B1cF9faW5wdXRfdHlwZV9uYW1lJ1xyXG4pXHJcbmNvbnN0IGpvYklucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gZWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uJ1xyXG4pXHJcbmNvbnN0IGF2YXRhcklucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX2F2YXRhcl91cmwnXHJcbilcclxuY29uc3QgcHJvZmlsZU5hbWU6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJylcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uOiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0Jy5wcm9maWxlX19kZXNjcmlwdGlvbidcclxuKVxyXG5jb25zdCBwbGFjZXNMaXN0OiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKVxyXG5jb25zdCBtb2RhbE5ld0NhcmQ6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfbmV3LWNhcmQnKVxyXG5jb25zdCBwcm9maWxlSW1hZ2U6IEhUTUxJbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKVxyXG5jb25zdCBjb25maXJtYXRpb25Nb2RhbDogSFRNTEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucG9wdXBfdHlwZV9kZWxldGVfY2FyZCdcclxuKVxyXG5jb25zdCBjYXJkTmFtZUlucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX2NhcmQtbmFtZSdcclxuKVxyXG5jb25zdCBpbWFnZVVybElucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX3VybCdcclxuKVxyXG5jb25zdCBtb2RhbEltYWdlOiBIVE1MSW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKVxyXG5jb25zdCBwb3B1cEltYWdlOiBIVE1MSW1hZ2VFbGVtZW50ID0gbW9kYWxJbWFnZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJylcclxuY29uc3QgcG9wdXBDYXB0aW9uOiBIVE1MRWxlbWVudCA9IG1vZGFsSW1hZ2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJylcclxuY29uc3QgcHJvZmlsZUF2YXRhcjogSFRNTEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKVxyXG5jb25zdCBkZWxldGVCdXR0b25TdWJtaXQ6IEhUTUxCdXR0b25FbGVtZW50ID0gY29uZmlybWF0aW9uTW9kYWwucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19idXR0b24tZGVsZXRlJ1xyXG4pXHJcbmxldCB1c2VySWQ6IHN0cmluZ1xyXG5cclxucHJvZmlsZUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG5cdG9wZW5Nb2RhbChlZGl0QXZhdGFyRm9ybSlcclxuXHRjbGVhclZhbGlkYXRpb24oZWRpdEF2YXRhckZvcm0sIGZvcm1TZXR0aW5ncylcclxufSlcclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblx0b3Blbk1vZGFsKG1vZGFsRWRpdClcclxuXHRjbGVhclZhbGlkYXRpb24oZWRpdEZvcm0sIGZvcm1TZXR0aW5ncylcclxuXHRzZXRGb3JtVmFsdWVzKClcclxufSlcclxuXHJcbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuXHRvcGVuTW9kYWwobW9kYWxOZXdDYXJkKVxyXG5cdGNsZWFyVmFsaWRhdGlvbihuZXdQbGFjZUZvcm0sIGZvcm1TZXR0aW5ncylcclxufSlcclxuXHJcbmNvbnN0IHNldEZvcm1WYWx1ZXMgPSAoKSA9PiB7XHJcblx0bmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnRcclxuXHRqb2JJbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudFxyXG59XHJcblxyXG5jb25zdCBoYW5kbGVGb3JtU3VibWl0ID0gKGV2dDogRXZlbnQpID0+IHtcclxuXHRldnQucHJldmVudERlZmF1bHQoKVxyXG5cdHJlbmRlckxvYWRpbmcodHJ1ZSlcclxuXHR1cGRhdGVVc2VyUHJvZmlsZShuYW1lSW5wdXQudmFsdWUsIGpvYklucHV0LnZhbHVlKVxyXG5cdFx0LnRoZW4oKGRhdGE6IHsgbmFtZTogc3RyaW5nOyBhYm91dDogc3RyaW5nIH0pID0+IHtcclxuXHRcdFx0cHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWVcclxuXHRcdFx0cHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dFxyXG5cdFx0fSlcclxuXHRcdC50aGVuKCgpID0+IGNsb3NlTW9kYWwobW9kYWxFZGl0KSlcclxuXHRcdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cdFx0LmZpbmFsbHkoKCkgPT4gcmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZUF2YXRhckZvcm1TdWJtaXQgPSAoZXZ0OiBFdmVudCkgPT4ge1xyXG5cdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0cmVuZGVyTG9hZGluZyh0cnVlKVxyXG5cdHVwZGF0ZUF2YXRhcihhdmF0YXJJbnB1dC52YWx1ZSlcclxuXHRcdC50aGVuKChkYXRhOiB7IGF2YXRhcjogc3RyaW5nIH0pID0+IHtcclxuXHRcdFx0cHJvZmlsZUF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7ZGF0YS5hdmF0YXJ9KWBcclxuXHRcdH0pXHJcblx0XHQudGhlbigoKSA9PiBjbG9zZU1vZGFsKGVkaXRBdmF0YXJGb3JtKSlcclxuXHRcdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cdFx0LmZpbmFsbHkoKCkgPT4gcmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZUNvbmZpcm1hdGlvbk1vZGFsID0gKFxyXG5cdGV2dDogRXZlbnQsXHJcblx0Y2FyZEVsZW1lbnQ6IEhUTUxFbGVtZW50LFxyXG5cdGNhcmRJZDogc3RyaW5nXHJcbikgPT4ge1xyXG5cdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0ZGVsZXRlQnV0dG9uU3VibWl0LnRleHRDb250ZW50ID0gJ9Cj0LTQsNC70LXQvdC40LUuLi4nXHJcblx0ZGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKVxyXG5cdFx0LnRoZW4oKCkgPT4gY2xvc2VNb2RhbChjb25maXJtYXRpb25Nb2RhbCkpXHJcblx0XHQuY2F0Y2goY2F0Y2hFcnJvcilcclxufVxyXG5cclxuY29uc3Qgb3BlbkltYWdlTW9kYWwgPSAoZXZ0OiBFdmVudCkgPT4ge1xyXG5cdGlmIChcclxuXHRcdGV2dC50YXJnZXQgaW5zdGFuY2VvZiBIVE1MSW1hZ2VFbGVtZW50ICYmXHJcblx0XHRldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2FyZF9faW1hZ2UnKVxyXG5cdCkge1xyXG5cdFx0Y29uc3QgY2FyZEVsZW1lbnQgPSBldnQudGFyZ2V0LmNsb3Nlc3QoJy5wbGFjZXNfX2l0ZW0nKVxyXG5cdFx0Y29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJykudGV4dENvbnRlbnRcclxuXHJcblx0XHRwb3B1cEltYWdlLnNyYyA9IGV2dC50YXJnZXQuZ2V0QXR0cmlidXRlKCdzcmMnKVxyXG5cdFx0cG9wdXBJbWFnZS5hbHQgPSBjYXJkVGl0bGVcclxuXHRcdHBvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmRUaXRsZVxyXG5cclxuXHRcdG9wZW5Nb2RhbChtb2RhbEltYWdlKVxyXG5cdH1cclxufVxyXG5cclxuY29uc3QgY3JlYXRlTmV3UGxhY2UgPSAoZXZ0OiBFdmVudCkgPT4ge1xyXG5cdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0cmVuZGVyTG9hZGluZyh0cnVlKVxyXG5cdHBvc3ROZXdDYXJkKGNhcmROYW1lSW5wdXQudmFsdWUsIGltYWdlVXJsSW5wdXQudmFsdWUpXHJcblx0XHQudGhlbigobmV3Q2FyZDogQ2FyZCkgPT4ge1xyXG5cdFx0XHRjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoXHJcblx0XHRcdFx0bmV3Q2FyZCxcclxuXHRcdFx0XHRoYW5kbGVEZWxldGVDYXJkLFxyXG5cdFx0XHRcdGhhbmRsZUxpa2VDYXJkLFxyXG5cdFx0XHRcdG9wZW5JbWFnZU1vZGFsLFxyXG5cdFx0XHRcdHVzZXJJZFxyXG5cdFx0XHQpXHJcblxyXG5cdFx0XHRwbGFjZXNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpXHJcblx0XHR9KVxyXG5cdFx0LnRoZW4oKCkgPT4gbmV3UGxhY2VGb3JtLnJlc2V0KCkpXHJcblx0XHQudGhlbigoKSA9PiBjbG9zZU1vZGFsKG1vZGFsTmV3Q2FyZCkpXHJcblx0XHQuY2F0Y2goY2F0Y2hFcnJvcilcclxuXHRcdC5maW5hbGx5KCgpID0+IHJlbmRlckxvYWRpbmcoZmFsc2UpKVxyXG59XHJcblxyXG5lZGl0QXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KVxyXG5lZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0KVxyXG5uZXdQbGFjZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgY3JlYXRlTmV3UGxhY2UpXHJcblxyXG5jb25zdCBmb3JtU2V0dGluZ3MgPSB7XHJcblx0Zm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcclxuXHRpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19pbnB1dCcsXHJcblx0c3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX2J1dHRvbicsXHJcblx0aW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19idXR0b25fZGlzYWJsZWQnLFxyXG5cdGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19pbnB1dF90eXBlX2Vycm9yJyxcclxuXHRlcnJvckNsYXNzOiAncG9wdXBfX2Vycm9yX3Zpc2libGUnXHJcbn1cclxuXHJcbmNvbnN0IHJlbmRlckNhcmRzID0gKGNhcmRzOiBDYXJkW10sIGN1cnJlbnRVc2VySWQ6IHN0cmluZykgPT4ge1xyXG5cdGNhcmRzLmZvckVhY2goKGNhcmQ6IENhcmQpID0+IHtcclxuXHRcdGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChcclxuXHRcdFx0Y2FyZCxcclxuXHRcdFx0aGFuZGxlRGVsZXRlQ2FyZCxcclxuXHRcdFx0aGFuZGxlTGlrZUNhcmQsXHJcblx0XHRcdG9wZW5JbWFnZU1vZGFsLFxyXG5cdFx0XHRjdXJyZW50VXNlcklkXHJcblx0XHQpXHJcblx0XHRwbGFjZXNMaXN0LmFwcGVuZChjYXJkRWxlbWVudClcclxuXHR9KVxyXG59XHJcblxyXG5jb25zdCByZW5kZXJMb2FkaW5nID0gKGlzTG9hZGluZzogYm9vbGVhbikgPT4ge1xyXG5cdGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9fYnV0dG9uJylcclxuXHRzdWJtaXRCdXR0b24uZm9yRWFjaChcclxuXHRcdGJ1dHRvbiA9PiAoYnV0dG9uLnRleHRDb250ZW50ID0gaXNMb2FkaW5nID8gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJyA6ICfQodC+0YXRgNCw0L3QuNGC0YwnKVxyXG5cdClcclxufVxyXG5cclxuUHJvbWlzZS5hbGwoW2dldFVzZXJJbmZvKCksIGdldEluaXRpYWxDYXJkcygpXSlcclxuXHQudGhlbigoW3VzZXJEYXRhLCBjYXJkc106IFtVc2VySW5mb1R5cGUsIENhcmRbXV0pID0+IHtcclxuXHRcdHVzZXJJZCA9IHVzZXJEYXRhLl9pZFxyXG5cdFx0cHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lXHJcblx0XHRwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dFxyXG5cdFx0cHJvZmlsZUF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dXNlckRhdGEuYXZhdGFyfSlgXHJcblxyXG5cdFx0cmVuZGVyQ2FyZHMoY2FyZHMsIHVzZXJJZClcclxuXHR9KVxyXG5cdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihmb3JtU2V0dGluZ3MpXHJcblxyXG5leHBvcnQge1xyXG5cdGNvbmZpcm1hdGlvbk1vZGFsLFxyXG5cdGhhbmRsZUNvbmZpcm1hdGlvbk1vZGFsLFxyXG5cdG1vZGFsTmV3Q2FyZCxcclxuXHRuZXdQbGFjZUZvcm0sXHJcblx0cGxhY2VzTGlzdCxcclxuXHRwcm9maWxlRGVzY3JpcHRpb24sXHJcblx0cHJvZmlsZU5hbWVcclxufVxyXG4iXSwibmFtZXMiOlsiY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJjb25maWciLCJiYXNlVXJsIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJjcmVhdGVDYXJkIiwiY2FyZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlQ2FyZCIsIm9wZW5JbWFnZU1vZGFsIiwiY3VycmVudFVzZXJJZCIsImNhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZSIsImNhcmRUaXRsZSIsImRlbGV0ZUJ1dHRvbiIsImxpa2VCdXR0b24iLCJsaWtlc0NvdW50RWxlbWVudCIsImNsb3Nlc3QiLCJvd25lciIsIl9pZCIsInN0eWxlIiwiZGlzcGxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJsaWtlcyIsInNvbWUiLCJsaWtlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZXZ0Iiwic3JjIiwibGluayIsImFsdCIsIm5hbWUiLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsInRvU3RyaW5nIiwiY2FyZElkIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwicmVtb3ZlIiwiY2F0Y2giLCJ1c2VySWQiLCJjb250YWlucyIsImxpa2VDYXJkIiwiZGF0YSIsInRvZ2dsZSIsIm1vZGFscyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpc0VzY0xpc3RlbmVyQWRkZWQiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEVzY0xpc3RlbmVyIiwicmVtb3ZlRXNjTGlzdGVuZXIiLCJjbG9zZU1vZGFsT25Fc2MiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwib3BlbmVkTW9kYWwiLCJmb3JFYWNoIiwidGFyZ2V0Iiwic2hvd0lucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsInNldHRpbmdzIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsZW1lbnQiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwicmVtb3ZlQXR0cmlidXRlIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsInNldEF0dHJpYnV0ZSIsImNsZWFyVmFsaWRhdGlvbiIsIkFycmF5IiwiZnJvbSIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImVkaXRGb3JtIiwiZm9ybXMiLCJuYW1lZEl0ZW0iLCJuZXdQbGFjZUZvcm0iLCJlZGl0QXZhdGFyRm9ybSIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJtb2RhbEVkaXQiLCJuYW1lSW5wdXQiLCJqb2JJbnB1dCIsImF2YXRhcklucHV0IiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwbGFjZXNMaXN0IiwibW9kYWxOZXdDYXJkIiwicHJvZmlsZUltYWdlIiwiY29uZmlybWF0aW9uTW9kYWwiLCJjYXJkTmFtZUlucHV0IiwiaW1hZ2VVcmxJbnB1dCIsIm1vZGFsSW1hZ2UiLCJwb3B1cEltYWdlIiwicG9wdXBDYXB0aW9uIiwicHJvZmlsZUF2YXRhciIsImZvcm1TZXR0aW5ncyIsInNldEZvcm1WYWx1ZXMiLCJ2YWx1ZSIsIkhUTUxJbWFnZUVsZW1lbnQiLCJnZXRBdHRyaWJ1dGUiLCJhdmF0YXIiLCJwcmV2ZW50RGVmYXVsdCIsInJlbmRlckxvYWRpbmciLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImJhY2tncm91bmRJbWFnZSIsImZpbmFsbHkiLCJhYm91dCIsIm5ld0NhcmQiLCJwcmVwZW5kIiwicmVzZXQiLCJmb3JtU2VsZWN0b3IiLCJpc0xvYWRpbmciLCJidXR0b24iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwiYXBwZW5kIiwicmVuZGVyQ2FyZHMiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInRyaW0iLCJkYXRhc2V0IiwidHlwZU1pc21hdGNoIiwidXJsIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiXSwic291cmNlUm9vdCI6IiJ9