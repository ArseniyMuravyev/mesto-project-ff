(()=>{"use strict";function e(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var t=function(e){return console.log(e)},n={baseUrl:"https://nomoreparties.co/v1/wff-cohort-5",headers:{authorization:"f019a5da-c98f-4c6e-b4b9-d7890c838afb","Content-Type":"application/json"}},r=function(e,t,n,r,o){var c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),a=c.querySelector(".card__image"),u=c.querySelector(".card__title"),i=c.querySelector(".card__delete-button"),l=c.querySelector(".card__like-button"),s=l.closest(".card").querySelector(".card__like-amount");return e.owner&&e.owner._id===o?i.addEventListener("click",(function(){return t(c,e._id)})):i.remove(),e.likes&&e.likes.some((function(e){return e._id===o}))&&l.classList.add("card__like-button_is-active"),l.addEventListener("click",(function(){return n(l,s,e._id,o)})),a.addEventListener("click",(function(e){return r(e)})),a.src=e.link,a.alt=e.name,u.textContent=e.name,s.textContent=(e.likes?e.likes.length:0).toString(),c},o=function(r,o,c,a){(function(t,r,o){return fetch("".concat(n.baseUrl,"/cards/likes/").concat(r),{method:t.classList.contains("card__like-button_is-active")?"DELETE":"PUT",headers:n.headers}).then(e)})(r,c).then((function(e){o.textContent=e.likes.length.toString(),r.classList.toggle("card__like-button_is-active")})).catch(t)},c=document.querySelectorAll(".popup"),a=!1,u=function(e){e.classList.add("popup__opened"),l()},i=function(e){e&&(e.classList.remove("popup__opened"),s())},l=function(){a||(document.addEventListener("keydown",d),a=!0)},s=function(){document.removeEventListener("keydown",d),a=!1},d=function(e){if("Escape"===e.key){var t=document.querySelector(".popup__opened");i(t)}};c.forEach((function(e){e.addEventListener("click",(function(t){(t.target===e||t.target.classList.contains("popup__close"))&&i(e)}))}));var p,_=function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));o&&(t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass))},f=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));r&&(t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent="")},m=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove(n.inactiveButtonClass)):(t.setAttribute("disabled","true"),t.classList.add(n.inactiveButtonClass))},v=function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector));n.forEach((function(n){f(e,n,t)}));var r=e.querySelector(t.submitButtonSelector);m(n,r,t)},y=document.forms.namedItem("edit_avatar"),h=document.forms.namedItem("edit_profile"),S=document.forms.namedItem("new_place"),b=document.querySelector(".popup_type_avatar"),q=document.querySelector(".popup_type_edit"),E=document.querySelector(".popup_type_image"),L=document.querySelector(".popup_type_new-card"),g=document.querySelector(".popup_type_delete_card"),C=document.querySelector(".profile__edit-button"),k=document.querySelector(".profile__add-button"),x=g.querySelector(".popup__button-delete"),A=h.querySelector(".popup__input_type_name"),U=h.querySelector(".popup__input_type_description"),T=document.querySelector(".popup__input_type_avatar_url"),w=document.querySelector(".profile__title"),D=document.querySelector(".profile__description"),B=document.querySelector(".profile__image"),I=document.querySelector(".places__list"),P=document.querySelector(".popup__input_type_card-name"),N=document.querySelector(".popup__input_type_url"),O=E.querySelector(".popup__image"),j=E.querySelector(".popup__caption"),H=document.querySelector(".profile__image"),J=function(){};B.addEventListener("click",(function(){u(b),v(y,K)})),C.addEventListener("click",(function(){u(q),v(h,K),M()})),k.addEventListener("click",(function(){u(L),v(S,K)}));var M=function(){A.value=w.textContent,U.value=D.textContent},z=function(r,o){J=function(){x.textContent="Удаление...",function(t){return fetch("".concat(n.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:n.headers}).then(e)}(o).then((function(){!function(e){e.remove()}(r),i(g)})).catch(t).finally((function(){x.textContent="Да"}))},u(g)},F=function(e){if(e.target instanceof HTMLImageElement&&e.target.classList.contains("card__image")){var t=e.target.closest(".places__item").querySelector(".card__title").textContent;O.src=e.target.getAttribute("src"),O.alt=t,j.textContent=t,u(E)}};y.addEventListener("submit",(function(r){var o;r.preventDefault(),Q(!0),(o=T.value,fetch("".concat(n.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:n.headers,body:JSON.stringify({avatar:o})}).then(e)).then((function(e){H.style.backgroundImage="url(".concat(e.avatar,")")})).then((function(){return i(b)})).catch(t).finally((function(){return Q(!1)}))})),h.addEventListener("submit",(function(r){var o,c;r.preventDefault(),Q(!0),(o=A.value,c=U.value,fetch("".concat(n.baseUrl,"/users/me"),{method:"PATCH",headers:n.headers,body:JSON.stringify({name:o,about:c})}).then(e)).then((function(e){w.textContent=e.name,D.textContent=e.about})).then((function(){return i(q)})).catch(t).finally((function(){return Q(!1)}))})),S.addEventListener("submit",(function(c){var a,u;c.preventDefault(),Q(!0),(a=P.value,u=N.value,fetch("".concat(n.baseUrl,"/cards"),{method:"POST",headers:n.headers,body:JSON.stringify({name:a,link:u,likes:0})}).then(e)).then((function(e){var t=r(e,z,o,F,p);I.prepend(t)})).then((function(){return S.reset()})).then((function(){return i(L)})).catch(t).finally((function(){return Q(!1)}))})),g.addEventListener("submit",(function(e){e.preventDefault(),J()}));var G,K={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Q=function(e){document.querySelectorAll(".popup__button").forEach((function(t){return t.textContent=e?"Сохранение...":"Сохранить"}))};Promise.all([fetch("".concat(n.baseUrl,"/users/me"),{headers:n.headers}).then(e),fetch("".concat(n.baseUrl,"/cards"),{headers:n.headers}).then(e)]).then((function(e){var t=e[0],n=e[1];p=t._id,w.textContent=t.name,D.textContent=t.about,H.style.backgroundImage="url(".concat(t.avatar,")"),function(e,t){e.forEach((function(e){var n=r(e,z,o,F,t);I.append(n)}))}(n,p)})).catch(t),G=K,Array.from(document.querySelectorAll(G.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);m(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?f(e,t,n):(_(e,t,t.validationMessage,n),""===t.value.trim()?_(e,t,t.dataset.error,n):t.validity.typeMismatch&&_(e,t,t.dataset.url,n))}(e,o,t),m(n,r,t)}))}))}(e,G)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0JzRSxFQzZHVDhDLEVENUdvQjlCLE1BQU1DLEtBQ3pDeEUsU0FBU3NDLGlCQUFpQmlCLEVBQVNrRSxlQUUzQnhFLFNBQVEsU0FBQ0csR0FDakJBLEVBQVl4QyxpQkFBaUIsVUFBVSxTQUFBTyxHQUN0Q0EsRUFBSTJGLGdCQUNMLElBNUJ3QixTQUN6QjFELEVBQ0FHLEdBRUEsSUFBTU8sRUFBZ0NTLE1BQU1DLEtBQzNDcEIsRUFBWWQsaUJBQWlCaUIsRUFBU2tCLGdCQUVqQ1YsRUFBbUNYLEVBQVluRCxjQUNwRHNELEVBQVNtQixzQkFHVmIsRUFBa0JDLEVBQVdDLEVBQWVSLEdBRTVDTyxFQUFVYixTQUFRLFNBQUNJLEdBQ2xCQSxFQUFhekMsaUJBQWlCLFNBQVMsWUFsRWQsU0FDMUJ3QyxFQUNBQyxFQUNBRSxHQUVLRixFQUFhVyxTQUFTQyxNQXVCMUJMLEVBQWVSLEVBQWFDLEVBQWNFLElBdEIxQ0osRUFDQ0MsRUFDQUMsRUFDQUEsRUFBYTRFLGtCQUNiMUUsR0FFaUMsS0FBOUJGLEVBQWFrRCxNQUFNMkIsT0FDdEIvRSxFQUNDQyxFQUNBQyxFQUNBQSxFQUFhOEUsUUFBUWpKLE1BQ3JCcUUsR0FFU0YsRUFBYVcsU0FBU29FLGNBQ2hDakYsRUFDQ0MsRUFDQUMsRUFDQUEsRUFBYThFLFFBQVFFLElBQ3JCOUUsR0FNSixDQXFDRytFLENBQW1CbEYsRUFBYUMsRUFBY0UsR0FDOUNNLEVBQWtCQyxFQUFXQyxFQUFlUixFQUM3QyxHQUNELEdBQ0QsQ0FVRWdGLENBQWtCbkYsRUFBYUcsRUFDaEMsRyIsInNvdXJjZXMiOlsid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvY29tcG9uZW50cy91dGlscy50cyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvYXBpLnRzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvY29tcG9uZW50cy9jYXJkLnRzIiwid2VicGFjazovL21lc3RvLXByb2plY3QtZmYvLi9zcmMvY29tcG9uZW50cy9tb2RhbC50cyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvdmFsaWRhdGlvbi50cyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGNoZWNrUmVzcG9uc2U8VD4ocmVzOiBSZXNwb25zZSk6IFByb21pc2U8VD4ge1xyXG5cdGlmIChyZXMub2spIHtcclxuXHRcdHJldHVybiByZXMuanNvbigpXHJcblx0fVxyXG5cdHJldHVybiBQcm9taXNlLnJlamVjdChg0J7RiNC40LHQutCwOiAke3Jlcy5zdGF0dXN9YClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNhdGNoRXJyb3IgPSAoZXJyb3I6IHN0cmluZyk6IHZvaWQgPT4gY29uc29sZS5sb2coZXJyb3IpXHJcbiIsImltcG9ydCB7IGNoZWNrUmVzcG9uc2UgfSBmcm9tICcuL3V0aWxzJ1xyXG5cclxuaW50ZXJmYWNlIENvbmZpZyB7XHJcblx0YmFzZVVybDogc3RyaW5nXHJcblx0aGVhZGVyczoge1xyXG5cdFx0YXV0aG9yaXphdGlvbjogc3RyaW5nXHJcblx0XHQnQ29udGVudC1UeXBlJzogc3RyaW5nXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBjb25maWc6IENvbmZpZyA9IHtcclxuXHRiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtNScsXHJcblx0aGVhZGVyczoge1xyXG5cdFx0YXV0aG9yaXphdGlvbjogJ2YwMTlhNWRhLWM5OGYtNGM2ZS1iNGI5LWQ3ODkwYzgzOGFmYicsXHJcblx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VXNlckluZm8gPSAoKTogUHJvbWlzZTx1bmtub3duPiA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuXHRcdGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCk6IFByb21pc2U8dW5rbm93bj4gPT4ge1xyXG5cdHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG5cdH0pLnRoZW4oY2hlY2tSZXNwb25zZSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXJQcm9maWxlID0gKFxyXG5cdG5hbWU6IHN0cmluZyxcclxuXHRhYm91dDogc3RyaW5nXHJcbik6IFByb21pc2U8dW5rbm93bj4gPT4ge1xyXG5cdHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcblx0XHRtZXRob2Q6ICdQQVRDSCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuXHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuXHRcdFx0bmFtZSxcclxuXHRcdFx0YWJvdXRcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcG9zdE5ld0NhcmQgPSAobmFtZTogc3RyaW5nLCBsaW5rOiBzdHJpbmcpOiBQcm9taXNlPHVua25vd24+ID0+IHtcclxuXHRyZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG5cdFx0bWV0aG9kOiAnUE9TVCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuXHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuXHRcdFx0bmFtZSxcclxuXHRcdFx0bGluayxcclxuXHRcdFx0bGlrZXM6IDBcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbGlrZUNhcmQgPSAoXHJcblx0bGlrZUJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQsXHJcblx0Y2FyZElkOiBzdHJpbmcsXHJcblx0dXNlcklkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx1bmtub3duPiA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcblx0XHRtZXRob2Q6IGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKVxyXG5cdFx0XHQ/ICdERUxFVEUnXHJcblx0XHRcdDogJ1BVVCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG5cdH0pLnRoZW4oY2hlY2tSZXNwb25zZSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmQgPSAoXHJcblx0Y2FyZElkOiBzdHJpbmdcclxuKTogUHJvbWlzZTx1bmtub3duPiA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcblx0XHRtZXRob2Q6ICdERUxFVEUnLFxyXG5cdFx0aGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuXHR9KS50aGVuKGNoZWNrUmVzcG9uc2UpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVBdmF0YXIgPSAoYXZhdGFyOiBzdHJpbmcpOiBQcm9taXNlPHVua25vd24+ID0+IHtcclxuXHRyZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuXHRcdG1ldGhvZDogJ1BBVENIJyxcclxuXHRcdGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG5cdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG5cdFx0XHRhdmF0YXJcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcbiIsImltcG9ydCB7IGxpa2VDYXJkIH0gZnJvbSAnLi9hcGknXHJcbmltcG9ydCB7IGNhdGNoRXJyb3IgfSBmcm9tICcuL3V0aWxzJ1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDYXJkIHtcclxuXHRvd25lcjoge1xyXG5cdFx0X2lkOiBzdHJpbmdcclxuXHR9XHJcblx0bGlrZXM/OiB7XHJcblx0XHRfaWQ6IHN0cmluZ1xyXG5cdH1bXVxyXG5cdF9pZDogc3RyaW5nXHJcblx0bGluazogc3RyaW5nXHJcblx0bmFtZTogc3RyaW5nXHJcbn1cclxuXHJcbmludGVyZmFjZSBMaWtlcyB7XHJcblx0bmFtZTogc3RyaW5nXHJcblx0YWJvdXQ6IHN0cmluZ1xyXG5cdGF2YXRhcjogc3RyaW5nXHJcblx0X2lkOiBzdHJpbmdcclxuXHRjb2hvcnQ6IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgY3JlYXRlQ2FyZCA9IChcclxuXHRjYXJkOiBDYXJkLFxyXG5cdGhhbmRsZURlbGV0ZUNhcmQ6IChjYXJkRWxlbWVudDogSFRNTExJRWxlbWVudCwgY2FyZElkOiBzdHJpbmcpID0+IHZvaWQsXHJcblx0aGFuZGxlTGlrZUNhcmQ6IChcclxuXHRcdGxpa2VCdXR0b246IEhUTUxCdXR0b25FbGVtZW50LFxyXG5cdFx0bGlrZXNDb3VudEVsZW1lbnQ6IEhUTUxTcGFuRWxlbWVudCxcclxuXHRcdGNhcmRJZDogc3RyaW5nLFxyXG5cdFx0Y3VycmVudFVzZXJJZDogc3RyaW5nXHJcblx0KSA9PiB2b2lkLFxyXG5cdG9wZW5JbWFnZU1vZGFsOiAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB2b2lkLFxyXG5cdGN1cnJlbnRVc2VySWQ6IHN0cmluZ1xyXG4pOiBIVE1MTElFbGVtZW50ID0+IHtcclxuXHRjb25zdCBjYXJkVGVtcGxhdGU6IEhUTUxUZW1wbGF0ZUVsZW1lbnQgPVxyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NhcmQtdGVtcGxhdGUnKVxyXG5cdGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuXHRcdC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXHJcblx0XHQuY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxMSUVsZW1lbnRcclxuXHRjb25zdCBjYXJkSW1hZ2U6IEhUTUxJbWFnZUVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9faW1hZ2UnKVxyXG5cdGNvbnN0IGNhcmRUaXRsZTogSFRNTFRpdGxlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpXHJcblx0Y29uc3QgZGVsZXRlQnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHQnLmNhcmRfX2RlbGV0ZS1idXR0b24nXHJcblx0KVxyXG5cdGNvbnN0IGxpa2VCdXR0b246IEhUTUxCdXR0b25FbGVtZW50ID1cclxuXHRcdGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWJ1dHRvbicpXHJcblx0Y29uc3QgbGlrZXNDb3VudEVsZW1lbnQ6IEhUTUxTcGFuRWxlbWVudCA9IGxpa2VCdXR0b25cclxuXHRcdC5jbG9zZXN0KCcuY2FyZCcpXHJcblx0XHQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYW1vdW50JylcclxuXHJcblx0aWYgKGNhcmQub3duZXIgJiYgY2FyZC5vd25lci5faWQgPT09IGN1cnJlbnRVc2VySWQpIHtcclxuXHRcdGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+XHJcblx0XHRcdGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGNhcmQuX2lkKVxyXG5cdFx0KVxyXG5cdH0gZWxzZSB7XHJcblx0XHRkZWxldGVCdXR0b24ucmVtb3ZlKClcclxuXHR9XHJcblxyXG5cdGNvbnN0IGlzTGlrZWRCeUN1cnJlbnRVc2VyID1cclxuXHRcdGNhcmQubGlrZXMgJiYgY2FyZC5saWtlcy5zb21lKGxpa2UgPT4gbGlrZS5faWQgPT09IGN1cnJlbnRVc2VySWQpXHJcblx0aWYgKGlzTGlrZWRCeUN1cnJlbnRVc2VyKSB7XHJcblx0XHRsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpXHJcblx0fVxyXG5cclxuXHRsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT5cclxuXHRcdGhhbmRsZUxpa2VDYXJkKGxpa2VCdXR0b24sIGxpa2VzQ291bnRFbGVtZW50LCBjYXJkLl9pZCwgY3VycmVudFVzZXJJZClcclxuXHQpXHJcblxyXG5cdGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiBvcGVuSW1hZ2VNb2RhbChldnQpKVxyXG5cclxuXHRjYXJkSW1hZ2Uuc3JjID0gY2FyZC5saW5rXHJcblx0Y2FyZEltYWdlLmFsdCA9IGNhcmQubmFtZVxyXG5cdGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGNhcmQubmFtZVxyXG5cdGxpa2VzQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gKFxyXG5cdFx0Y2FyZC5saWtlcyA/IGNhcmQubGlrZXMubGVuZ3RoIDogMFxyXG5cdCkudG9TdHJpbmcoKVxyXG5cclxuXHRyZXR1cm4gY2FyZEVsZW1lbnRcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGhhbmRsZURlbGV0ZUNhcmRDbGljayA9IChjYXJkRWxlbWVudDogSFRNTExJRWxlbWVudCkgPT4ge1xyXG5cdGNhcmRFbGVtZW50LnJlbW92ZSgpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBoYW5kbGVMaWtlQ2FyZCA9IChcclxuXHRsaWtlQnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCxcclxuXHRsaWtlc0NvdW50RWxlbWVudDogSFRNTFNwYW5FbGVtZW50LFxyXG5cdGNhcmRJZDogc3RyaW5nLFxyXG5cdGN1cnJlbnRVc2VySWQ6IHN0cmluZ1xyXG4pID0+IHtcclxuXHRsaWtlQ2FyZChsaWtlQnV0dG9uLCBjYXJkSWQsIGN1cnJlbnRVc2VySWQpXHJcblx0XHQudGhlbigoZGF0YTogeyBsaWtlczogTGlrZXNbXSB9KSA9PiB7XHJcblx0XHRcdGxpa2VzQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gZGF0YS5saWtlcy5sZW5ndGgudG9TdHJpbmcoKVxyXG5cdFx0XHRsaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpXHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKGNhdGNoRXJyb3IpXHJcbn1cclxuIiwiY29uc3QgbW9kYWxzOiBOb2RlTGlzdE9mPEhUTUxEaXZFbGVtZW50PiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cCcpXHJcbmxldCBpc0VzY0xpc3RlbmVyQWRkZWQ6IGJvb2xlYW4gPSBmYWxzZVxyXG5cclxuZXhwb3J0IGNvbnN0IG9wZW5Nb2RhbCA9IChtb2RhbDogSFRNTERpdkVsZW1lbnQpID0+IHtcclxuXHRtb2RhbC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9fb3BlbmVkJylcclxuXHRhZGRFc2NMaXN0ZW5lcigpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjbG9zZU1vZGFsID0gKG1vZGFsOiBIVE1MRGl2RWxlbWVudCB8IG51bGwpID0+IHtcclxuXHRpZiAobW9kYWwpIHtcclxuXHRcdG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX19vcGVuZWQnKVxyXG5cdFx0cmVtb3ZlRXNjTGlzdGVuZXIoKVxyXG5cdH1cclxufVxyXG5cclxuY29uc3QgYWRkRXNjTGlzdGVuZXIgPSAoKSA9PiB7XHJcblx0aWYgKCFpc0VzY0xpc3RlbmVyQWRkZWQpIHtcclxuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZU1vZGFsT25Fc2MpXHJcblx0XHRpc0VzY0xpc3RlbmVyQWRkZWQgPSB0cnVlXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCByZW1vdmVFc2NMaXN0ZW5lciA9ICgpID0+IHtcclxuXHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgY2xvc2VNb2RhbE9uRXNjKVxyXG5cdGlzRXNjTGlzdGVuZXJBZGRlZCA9IGZhbHNlXHJcbn1cclxuXHJcbmNvbnN0IGNsb3NlTW9kYWxPbkVzYyA9IChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcclxuXHRpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuXHRcdGNvbnN0IG9wZW5lZE1vZGFsOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fb3BlbmVkJylcclxuXHRcdGNsb3NlTW9kYWwob3BlbmVkTW9kYWwpXHJcblx0fVxyXG59XHJcblxyXG5tb2RhbHMuZm9yRWFjaChtb2RhbCA9PiB7XHJcblx0bW9kYWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldnQgPT4ge1xyXG5cdFx0aWYgKFxyXG5cdFx0XHRldnQudGFyZ2V0ID09PSBtb2RhbCB8fFxyXG5cdFx0XHQoZXZ0LnRhcmdldCBhcyBIVE1MRGl2RWxlbWVudCkuY2xhc3NMaXN0LmNvbnRhaW5zKCdwb3B1cF9fY2xvc2UnKVxyXG5cdFx0KSB7XHJcblx0XHRcdGNsb3NlTW9kYWwobW9kYWwpXHJcblx0XHR9XHJcblx0fSlcclxufSlcclxuIiwiaW50ZXJmYWNlIFZhbGlkYXRpb25TZXR0aW5ncyB7XHJcblx0Zm9ybVNlbGVjdG9yOiBzdHJpbmdcclxuXHRpbnB1dFNlbGVjdG9yOiBzdHJpbmdcclxuXHRzdWJtaXRCdXR0b25TZWxlY3Rvcjogc3RyaW5nXHJcblx0aW5hY3RpdmVCdXR0b25DbGFzczogc3RyaW5nXHJcblx0aW5wdXRFcnJvckNsYXNzOiBzdHJpbmdcclxuXHRlcnJvckNsYXNzOiBzdHJpbmdcclxufVxyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxGb3JtRWxlbWVudCxcclxuXHRpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXHJcblx0ZXJyb3JNZXNzYWdlOiBzdHJpbmcsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRjb25zdCBlcnJvckVsZW1lbnQ6IEhUTUxTcGFuRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuXHQpXHJcblx0aWYgKGVycm9yRWxlbWVudCkge1xyXG5cdFx0aW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKVxyXG5cdFx0ZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlXHJcblx0XHRlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5lcnJvckNsYXNzKVxyXG5cdH1cclxufVxyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxGb3JtRWxlbWVudCxcclxuXHRpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRjb25zdCBlcnJvckVsZW1lbnQ6IEhUTUxTcGFuRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuXHQpXHJcblx0aWYgKGVycm9yRWxlbWVudCkge1xyXG5cdFx0aW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKVxyXG5cdFx0ZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuZXJyb3JDbGFzcylcclxuXHRcdGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxGb3JtRWxlbWVudCxcclxuXHRpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG5cdFx0c2hvd0lucHV0RXJyb3IoXHJcblx0XHRcdGZvcm1FbGVtZW50LFxyXG5cdFx0XHRpbnB1dEVsZW1lbnQsXHJcblx0XHRcdGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuXHRcdFx0c2V0dGluZ3NcclxuXHRcdClcclxuXHRcdGlmIChpbnB1dEVsZW1lbnQudmFsdWUudHJpbSgpID09PSAnJykge1xyXG5cdFx0XHRzaG93SW5wdXRFcnJvcihcclxuXHRcdFx0XHRmb3JtRWxlbWVudCxcclxuXHRcdFx0XHRpbnB1dEVsZW1lbnQsXHJcblx0XHRcdFx0aW5wdXRFbGVtZW50LmRhdGFzZXQuZXJyb3IsXHJcblx0XHRcdFx0c2V0dGluZ3NcclxuXHRcdFx0KVxyXG5cdFx0fSBlbHNlIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkudHlwZU1pc21hdGNoKSB7XHJcblx0XHRcdHNob3dJbnB1dEVycm9yKFxyXG5cdFx0XHRcdGZvcm1FbGVtZW50LFxyXG5cdFx0XHRcdGlucHV0RWxlbWVudCxcclxuXHRcdFx0XHRpbnB1dEVsZW1lbnQuZGF0YXNldC51cmwsXHJcblx0XHRcdFx0c2V0dGluZ3NcclxuXHRcdFx0KVxyXG5cdFx0fVxyXG5cdH0gZWxzZSB7XHJcblx0XHRoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncylcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3Q6IEhUTUxJbnB1dEVsZW1lbnRbXSkgPT4ge1xyXG5cdHJldHVybiBpbnB1dExpc3Quc29tZShpbnB1dEVsZW1lbnQgPT4ge1xyXG5cdFx0cmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuXHR9KVxyXG59XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChcclxuXHRpbnB1dExpc3Q6IEhUTUxJbnB1dEVsZW1lbnRbXSxcclxuXHRidXR0b25FbGVtZW50OiBIVE1MQnV0dG9uRWxlbWVudCxcclxuXHRzZXR0aW5nczogVmFsaWRhdGlvblNldHRpbmdzXHJcbikgPT4ge1xyXG5cdGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG5cdFx0YnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ3RydWUnKVxyXG5cdFx0YnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpXHJcblx0fSBlbHNlIHtcclxuXHRcdGJ1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpXHJcblx0XHRidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcylcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKFxyXG5cdGZvcm1FbGVtZW50OiBIVE1MRm9ybUVsZW1lbnQsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRjb25zdCBpbnB1dExpc3Q6IEhUTUxJbnB1dEVsZW1lbnRbXSA9IEFycmF5LmZyb20oXHJcblx0XHRmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmlucHV0U2VsZWN0b3IpXHJcblx0KVxyXG5cdGNvbnN0IGJ1dHRvbkVsZW1lbnQ6IEhUTUxCdXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHRcdHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcblx0KVxyXG5cclxuXHR0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKVxyXG5cclxuXHRpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50KSA9PiB7XHJcblx0XHRpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcblx0XHRcdGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncylcclxuXHRcdFx0dG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncylcclxuXHRcdH0pXHJcblx0fSlcclxufVxyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChzZXR0aW5nczogVmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XHJcblx0Y29uc3QgZm9ybUxpc3Q6IEhUTUxGb3JtRWxlbWVudFtdID0gQXJyYXkuZnJvbShcclxuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKVxyXG5cdClcclxuXHRmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudDogSFRNTEZvcm1FbGVtZW50KSA9PiB7XHJcblx0XHRmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBldnQgPT4ge1xyXG5cdFx0XHRldnQucHJldmVudERlZmF1bHQoKVxyXG5cdFx0fSlcclxuXHRcdHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBzZXR0aW5ncylcclxuXHR9KVxyXG59XHJcblxyXG5jb25zdCBjbGVhclZhbGlkYXRpb24gPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxGb3JtRWxlbWVudCxcclxuXHRzZXR0aW5nczogVmFsaWRhdGlvblNldHRpbmdzXHJcbikgPT4ge1xyXG5cdGNvbnN0IGlucHV0TGlzdDogSFRNTElucHV0RWxlbWVudFtdID0gQXJyYXkuZnJvbShcclxuXHRcdGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcclxuXHQpXHJcblx0aW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudCkgPT4ge1xyXG5cdFx0aGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgc2V0dGluZ3MpXHJcblx0fSlcclxuXHJcblx0Y29uc3QgYnV0dG9uRWxlbWVudDogSFRNTEJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0c2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuXHQpXHJcblx0dG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBzZXR0aW5ncylcclxufVxyXG5cclxuZXhwb3J0IHsgY2xlYXJWYWxpZGF0aW9uLCBlbmFibGVWYWxpZGF0aW9uIH1cclxuIiwiaW1wb3J0ICcuLi9wYWdlcy9pbmRleC5jc3MnXHJcbmltcG9ydCB7XHJcblx0ZGVsZXRlQ2FyZCxcclxuXHRnZXRJbml0aWFsQ2FyZHMsXHJcblx0Z2V0VXNlckluZm8sXHJcblx0cG9zdE5ld0NhcmQsXHJcblx0dXBkYXRlQXZhdGFyLFxyXG5cdHVwZGF0ZVVzZXJQcm9maWxlXHJcbn0gZnJvbSAnLi9hcGknXHJcbmltcG9ydCB7IENhcmQsIGNyZWF0ZUNhcmQsIGhhbmRsZURlbGV0ZUNhcmRDbGljaywgaGFuZGxlTGlrZUNhcmQgfSBmcm9tICcuL2NhcmQnXHJcbmltcG9ydCB7IGNsb3NlTW9kYWwsIG9wZW5Nb2RhbCB9IGZyb20gJy4vbW9kYWwnXHJcbmltcG9ydCB7IGNhdGNoRXJyb3IgfSBmcm9tICcuL3V0aWxzJ1xyXG5pbXBvcnQgeyBjbGVhclZhbGlkYXRpb24sIGVuYWJsZVZhbGlkYXRpb24gfSBmcm9tICcuL3ZhbGlkYXRpb24nXHJcblxyXG5pbnRlcmZhY2UgVXNlckluZm9UeXBlIHtcclxuXHRfaWQ6IHN0cmluZ1xyXG5cdG5hbWU6IHN0cmluZ1xyXG5cdGFib3V0OiBzdHJpbmdcclxuXHRhdmF0YXI6IHN0cmluZ1xyXG59XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyRm9ybTogSFRNTEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXMubmFtZWRJdGVtKCdlZGl0X2F2YXRhcicpXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybTogSFRNTEZvcm1FbGVtZW50ID1cclxuXHRkb2N1bWVudC5mb3Jtcy5uYW1lZEl0ZW0oJ2VkaXRfcHJvZmlsZScpXHJcbmNvbnN0IG5ld1BsYWNlRm9ybTogSFRNTEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXMubmFtZWRJdGVtKCduZXdfcGxhY2UnKVxyXG5jb25zdCBtb2RhbEVkaXRBdmF0YXI6IEhUTUxEaXZFbGVtZW50ID1cclxuXHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hdmF0YXInKVxyXG5jb25zdCBtb2RhbEVkaXRQcm9maWxlOiBIVE1MRGl2RWxlbWVudCA9XHJcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfZWRpdCcpXHJcbmNvbnN0IG1vZGFsSW1hZ2U6IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfaW1hZ2UnKVxyXG5jb25zdCBtb2RhbE5ld0NhcmQ6IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX3R5cGVfbmV3LWNhcmQnXHJcbilcclxuY29uc3QgbW9kYWxEZWxldGVDb25maXJtYXRpb246IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX3R5cGVfZGVsZXRlX2NhcmQnXHJcbilcclxuY29uc3QgZWRpdEJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucHJvZmlsZV9fZWRpdC1idXR0b24nXHJcbilcclxuY29uc3QgYWRkQnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0Jy5wcm9maWxlX19hZGQtYnV0dG9uJ1xyXG4pXHJcbmNvbnN0IGRlbGV0ZUJ1dHRvblN1Ym1pdDogSFRNTEJ1dHRvbkVsZW1lbnQgPVxyXG5cdG1vZGFsRGVsZXRlQ29uZmlybWF0aW9uLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uLWRlbGV0ZScpXHJcbmNvbnN0IG5hbWVJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucG9wdXBfX2lucHV0X3R5cGVfbmFtZSdcclxuKVxyXG5jb25zdCBqb2JJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IGVkaXRQcm9maWxlRm9ybS5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb24nXHJcbilcclxuY29uc3QgYXZhdGFySW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucG9wdXBfX2lucHV0X3R5cGVfYXZhdGFyX3VybCdcclxuKVxyXG5jb25zdCBwcm9maWxlTmFtZTogSFRNTFRpdGxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpXHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbjogSFRNTFBhcmFncmFwaEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucHJvZmlsZV9fZGVzY3JpcHRpb24nXHJcbilcclxuY29uc3QgcHJvZmlsZUltYWdlOiBIVE1MSW1hZ2VFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJylcclxuY29uc3QgcGxhY2VzTGlzdDogSFRNTFVMaXN0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGFjZXNfX2xpc3QnKVxyXG5jb25zdCBjYXJkTmFtZUlucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX2NhcmQtbmFtZSdcclxuKVxyXG5jb25zdCBpbWFnZVVybElucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX3VybCdcclxuKVxyXG5jb25zdCBwb3B1cEltYWdlOiBIVE1MSW1hZ2VFbGVtZW50ID0gbW9kYWxJbWFnZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJylcclxuY29uc3QgcG9wdXBDYXB0aW9uOiBIVE1MUGFyYWdyYXBoRWxlbWVudCA9XHJcblx0bW9kYWxJbWFnZS5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKVxyXG5jb25zdCBwcm9maWxlQXZhdGFyOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZScpXHJcbmxldCB1c2VySWQ6IHN0cmluZ1xyXG5sZXQgc3VibWl0Rm9ybUNvbmZpcm0gPSAoKTogdm9pZCA9PiB7fVxyXG5cclxucHJvZmlsZUltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG5cdG9wZW5Nb2RhbChtb2RhbEVkaXRBdmF0YXIpXHJcblx0Y2xlYXJWYWxpZGF0aW9uKGVkaXRBdmF0YXJGb3JtLCBmb3JtU2V0dGluZ3MpXHJcbn0pXHJcblxyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG5cdG9wZW5Nb2RhbChtb2RhbEVkaXRQcm9maWxlKVxyXG5cdGNsZWFyVmFsaWRhdGlvbihlZGl0UHJvZmlsZUZvcm0sIGZvcm1TZXR0aW5ncylcclxuXHRzZXRGb3JtVmFsdWVzKClcclxufSlcclxuXHJcbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuXHRvcGVuTW9kYWwobW9kYWxOZXdDYXJkKVxyXG5cdGNsZWFyVmFsaWRhdGlvbihuZXdQbGFjZUZvcm0sIGZvcm1TZXR0aW5ncylcclxufSlcclxuXHJcbmNvbnN0IHNldEZvcm1WYWx1ZXMgPSAoKSA9PiB7XHJcblx0bmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnRcclxuXHRqb2JJbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudFxyXG59XHJcblxyXG5jb25zdCBoYW5kbGVGb3JtU3VibWl0ID0gKGV2dDogTW91c2VFdmVudCkgPT4ge1xyXG5cdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0cmVuZGVyTG9hZGluZyh0cnVlKVxyXG5cdHVwZGF0ZVVzZXJQcm9maWxlKG5hbWVJbnB1dC52YWx1ZSwgam9iSW5wdXQudmFsdWUpXHJcblx0XHQudGhlbigoZGF0YTogeyBuYW1lOiBzdHJpbmc7IGFib3V0OiBzdHJpbmcgfSkgPT4ge1xyXG5cdFx0XHRwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZVxyXG5cdFx0XHRwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0XHJcblx0XHR9KVxyXG5cdFx0LnRoZW4oKCkgPT4gY2xvc2VNb2RhbChtb2RhbEVkaXRQcm9maWxlKSlcclxuXHRcdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cdFx0LmZpbmFsbHkoKCkgPT4gcmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZUF2YXRhckZvcm1TdWJtaXQgPSAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XHJcblx0ZXZ0LnByZXZlbnREZWZhdWx0KClcclxuXHRyZW5kZXJMb2FkaW5nKHRydWUpXHJcblx0dXBkYXRlQXZhdGFyKGF2YXRhcklucHV0LnZhbHVlKVxyXG5cdFx0LnRoZW4oKGRhdGE6IHsgYXZhdGFyOiBzdHJpbmcgfSkgPT4ge1xyXG5cdFx0XHRwcm9maWxlQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHtkYXRhLmF2YXRhcn0pYFxyXG5cdFx0fSlcclxuXHRcdC50aGVuKCgpID0+IGNsb3NlTW9kYWwobW9kYWxFZGl0QXZhdGFyKSlcclxuXHRcdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cdFx0LmZpbmFsbHkoKCkgPT4gcmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZURlbGV0ZUNhcmQgPSAoY2FyZEVsZW1lbnQ6IEhUTUxMSUVsZW1lbnQsIGNhcmRJZDogc3RyaW5nKSA9PiB7XHJcblx0c3VibWl0Rm9ybUNvbmZpcm0gPSAoKSA9PiB7XHJcblx0XHRkZWxldGVCdXR0b25TdWJtaXQudGV4dENvbnRlbnQgPSAn0KPQtNCw0LvQtdC90LjQtS4uLidcclxuXHRcdGRlbGV0ZUNhcmQoY2FyZElkKVxyXG5cdFx0XHQudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0aGFuZGxlRGVsZXRlQ2FyZENsaWNrKGNhcmRFbGVtZW50KVxyXG5cdFx0XHRcdGNsb3NlTW9kYWwobW9kYWxEZWxldGVDb25maXJtYXRpb24pXHJcblx0XHRcdH0pXHJcblx0XHRcdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cdFx0XHQuZmluYWxseSgoKSA9PiB7XHJcblx0XHRcdFx0ZGVsZXRlQnV0dG9uU3VibWl0LnRleHRDb250ZW50ID0gJ9CU0LAnXHJcblx0XHRcdH0pXHJcblx0fVxyXG5cdG9wZW5Nb2RhbChtb2RhbERlbGV0ZUNvbmZpcm1hdGlvbilcclxufVxyXG5cclxuY29uc3Qgb3BlbkltYWdlTW9kYWwgPSAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XHJcblx0aWYgKFxyXG5cdFx0ZXZ0LnRhcmdldCBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQgJiZcclxuXHRcdGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19pbWFnZScpXHJcblx0KSB7XHJcblx0XHRjb25zdCBjYXJkRWxlbWVudDogSFRNTExJRWxlbWVudCA9IGV2dC50YXJnZXQuY2xvc2VzdCgnLnBsYWNlc19faXRlbScpXHJcblx0XHRjb25zdCBjYXJkVGl0bGU6IHN0cmluZyA9XHJcblx0XHRcdGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50XHJcblxyXG5cdFx0cG9wdXBJbWFnZS5zcmMgPSBldnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnc3JjJylcclxuXHRcdHBvcHVwSW1hZ2UuYWx0ID0gY2FyZFRpdGxlXHJcblx0XHRwb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBjYXJkVGl0bGVcclxuXHJcblx0XHRvcGVuTW9kYWwobW9kYWxJbWFnZSlcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGNyZWF0ZU5ld1BsYWNlID0gKGV2dDogTW91c2VFdmVudCkgPT4ge1xyXG5cdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0cmVuZGVyTG9hZGluZyh0cnVlKVxyXG5cdHBvc3ROZXdDYXJkKGNhcmROYW1lSW5wdXQudmFsdWUsIGltYWdlVXJsSW5wdXQudmFsdWUpXHJcblx0XHQudGhlbigobmV3Q2FyZDogQ2FyZCkgPT4ge1xyXG5cdFx0XHRjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoXHJcblx0XHRcdFx0bmV3Q2FyZCxcclxuXHRcdFx0XHRoYW5kbGVEZWxldGVDYXJkLFxyXG5cdFx0XHRcdGhhbmRsZUxpa2VDYXJkLFxyXG5cdFx0XHRcdG9wZW5JbWFnZU1vZGFsLFxyXG5cdFx0XHRcdHVzZXJJZFxyXG5cdFx0XHQpIGFzIEhUTUxMSUVsZW1lbnRcclxuXHJcblx0XHRcdHBsYWNlc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudClcclxuXHRcdH0pXHJcblx0XHQudGhlbigoKSA9PiBuZXdQbGFjZUZvcm0ucmVzZXQoKSlcclxuXHRcdC50aGVuKCgpID0+IGNsb3NlTW9kYWwobW9kYWxOZXdDYXJkKSlcclxuXHRcdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cdFx0LmZpbmFsbHkoKCkgPT4gcmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbn1cclxuXHJcbmVkaXRBdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQpXHJcbmVkaXRQcm9maWxlRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVGb3JtU3VibWl0KVxyXG5uZXdQbGFjZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgY3JlYXRlTmV3UGxhY2UpXHJcbm1vZGFsRGVsZXRlQ29uZmlybWF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRldnQucHJldmVudERlZmF1bHQoKVxyXG5cdHN1Ym1pdEZvcm1Db25maXJtKClcclxufSlcclxuXHJcbmNvbnN0IGZvcm1TZXR0aW5ncyA9IHtcclxuXHRmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG5cdGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuXHRzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcclxuXHRpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXHJcblx0aW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG5cdGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZSdcclxufVxyXG5cclxuY29uc3QgcmVuZGVyQ2FyZHMgPSAoY2FyZHM6IENhcmRbXSwgY3VycmVudFVzZXJJZDogc3RyaW5nKSA9PiB7XHJcblx0Y2FyZHMuZm9yRWFjaCgoY2FyZDogQ2FyZCkgPT4ge1xyXG5cdFx0Y29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKFxyXG5cdFx0XHRjYXJkLFxyXG5cdFx0XHRoYW5kbGVEZWxldGVDYXJkLFxyXG5cdFx0XHRoYW5kbGVMaWtlQ2FyZCxcclxuXHRcdFx0b3BlbkltYWdlTW9kYWwsXHJcblx0XHRcdGN1cnJlbnRVc2VySWRcclxuXHRcdCkgYXMgSFRNTExJRWxlbWVudFxyXG5cdFx0cGxhY2VzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpXHJcblx0fSlcclxufVxyXG5cclxuY29uc3QgcmVuZGVyTG9hZGluZyA9IChpc0xvYWRpbmc6IGJvb2xlYW4pID0+IHtcclxuXHRjb25zdCBzdWJtaXRCdXR0b246IE5vZGVMaXN0T2Y8SFRNTEJ1dHRvbkVsZW1lbnQ+ID1cclxuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wb3B1cF9fYnV0dG9uJylcclxuXHRzdWJtaXRCdXR0b24uZm9yRWFjaChcclxuXHRcdChidXR0b246IEhUTUxCdXR0b25FbGVtZW50KSA9PlxyXG5cdFx0XHQoYnV0dG9uLnRleHRDb250ZW50ID0gaXNMb2FkaW5nID8gJ9Ch0L7RhdGA0LDQvdC10L3QuNC1Li4uJyA6ICfQodC+0YXRgNCw0L3QuNGC0YwnKVxyXG5cdClcclxufVxyXG5cclxuUHJvbWlzZS5hbGwoW2dldFVzZXJJbmZvKCksIGdldEluaXRpYWxDYXJkcygpXSlcclxuXHQudGhlbigoW3VzZXJEYXRhLCBjYXJkc106IFtVc2VySW5mb1R5cGUsIENhcmRbXV0pID0+IHtcclxuXHRcdHVzZXJJZCA9IHVzZXJEYXRhLl9pZFxyXG5cdFx0cHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lXHJcblx0XHRwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dFxyXG5cdFx0cHJvZmlsZUF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dXNlckRhdGEuYXZhdGFyfSlgXHJcblxyXG5cdFx0cmVuZGVyQ2FyZHMoY2FyZHMsIHVzZXJJZClcclxuXHR9KVxyXG5cdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihmb3JtU2V0dGluZ3MpXHJcblxyXG5leHBvcnQge1xyXG5cdG1vZGFsRGVsZXRlQ29uZmlybWF0aW9uLFxyXG5cdG1vZGFsTmV3Q2FyZCxcclxuXHRuZXdQbGFjZUZvcm0sXHJcblx0cGxhY2VzTGlzdCxcclxuXHRwcm9maWxlRGVzY3JpcHRpb24sXHJcblx0cHJvZmlsZU5hbWVcclxufVxyXG4iXSwibmFtZXMiOlsiY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjYXRjaEVycm9yIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiY29uZmlnIiwiYmFzZVVybCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwiY3JlYXRlQ2FyZCIsImNhcmQiLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUNhcmQiLCJvcGVuSW1hZ2VNb2RhbCIsImN1cnJlbnRVc2VySWQiLCJjYXJkRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJkZWxldGVCdXR0b24iLCJsaWtlQnV0dG9uIiwibGlrZXNDb3VudEVsZW1lbnQiLCJjbG9zZXN0Iiwib3duZXIiLCJfaWQiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwibGlrZXMiLCJzb21lIiwibGlrZSIsImNsYXNzTGlzdCIsImFkZCIsImV2dCIsInNyYyIsImxpbmsiLCJhbHQiLCJuYW1lIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJ0b1N0cmluZyIsImNhcmRJZCIsInVzZXJJZCIsImZldGNoIiwibWV0aG9kIiwiY29udGFpbnMiLCJ0aGVuIiwibGlrZUNhcmQiLCJkYXRhIiwidG9nZ2xlIiwiY2F0Y2giLCJtb2RhbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaXNFc2NMaXN0ZW5lckFkZGVkIiwib3Blbk1vZGFsIiwibW9kYWwiLCJhZGRFc2NMaXN0ZW5lciIsImNsb3NlTW9kYWwiLCJyZW1vdmVFc2NMaXN0ZW5lciIsImNsb3NlTW9kYWxPbkVzYyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJvcGVuZWRNb2RhbCIsImZvckVhY2giLCJ0YXJnZXQiLCJzaG93SW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwic2V0dGluZ3MiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwic2V0QXR0cmlidXRlIiwiY2xlYXJWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZWRpdEF2YXRhckZvcm0iLCJmb3JtcyIsIm5hbWVkSXRlbSIsImVkaXRQcm9maWxlRm9ybSIsIm5ld1BsYWNlRm9ybSIsIm1vZGFsRWRpdEF2YXRhciIsIm1vZGFsRWRpdFByb2ZpbGUiLCJtb2RhbEltYWdlIiwibW9kYWxOZXdDYXJkIiwibW9kYWxEZWxldGVDb25maXJtYXRpb24iLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwiZGVsZXRlQnV0dG9uU3VibWl0IiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJhdmF0YXJJbnB1dCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUltYWdlIiwicGxhY2VzTGlzdCIsImNhcmROYW1lSW5wdXQiLCJpbWFnZVVybElucHV0IiwicG9wdXBJbWFnZSIsInBvcHVwQ2FwdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJzdWJtaXRGb3JtQ29uZmlybSIsImZvcm1TZXR0aW5ncyIsInNldEZvcm1WYWx1ZXMiLCJ2YWx1ZSIsImRlbGV0ZUNhcmQiLCJoYW5kbGVEZWxldGVDYXJkQ2xpY2siLCJmaW5hbGx5IiwiSFRNTEltYWdlRWxlbWVudCIsImdldEF0dHJpYnV0ZSIsImF2YXRhciIsInByZXZlbnREZWZhdWx0IiwicmVuZGVyTG9hZGluZyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwic3R5bGUiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJhYm91dCIsIm5ld0NhcmQiLCJwcmVwZW5kIiwicmVzZXQiLCJmb3JtU2VsZWN0b3IiLCJpc0xvYWRpbmciLCJidXR0b24iLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwiYXBwZW5kIiwicmVuZGVyQ2FyZHMiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInRyaW0iLCJkYXRhc2V0IiwidHlwZU1pc21hdGNoIiwidXJsIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiXSwic291cmNlUm9vdCI6IiJ9