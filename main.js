(()=>{"use strict";function e(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var t=function(e){return console.log(e)},n={baseUrl:"https://nomoreparties.co/v1/wff-cohort-5",headers:{authorization:"f019a5da-c98f-4c6e-b4b9-d7890c838afb","Content-Type":"application/json"}},r=function(e,t,n,r,o){var c=document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0),a=c.querySelector(".card__image"),u=c.querySelector(".card__title"),i=c.querySelector(".card__delete-button"),l=c.querySelector(".card__like-button"),s=l.closest(".card").querySelector(".card__like-amount");return e.owner&&e.owner._id===o?(i.style.display="block",i.addEventListener("click",(function(){return t(c,e._id)}))):i.style.display="none",e.likes&&e.likes.some((function(e){return e._id===o}))&&l.classList.add("card__like-button_is-active"),l.addEventListener("click",(function(){return n(l,s,e._id,o)})),a.addEventListener("click",(function(e){return r(e)})),a.src=e.link,a.alt=e.name,u.textContent=e.name,s.textContent=(e.likes?e.likes.length:0).toString(),c},o=function(r,o){(function(t,r){return fetch("".concat(n.baseUrl,"/cards/").concat(r),{method:"DELETE",headers:n.headers}).then(e)})(0,o).then((function(){return r.remove()})).catch(t)},c=function(r,o,c,a){(function(t,r,o){return fetch("".concat(n.baseUrl,"/cards/likes/").concat(r),{method:t.classList.contains("card__like-button_is-active")?"DELETE":"PUT",headers:n.headers}).then(e)})(r,c).then((function(e){o.textContent=e.likes.length.toString(),r.classList.toggle("card__like-button_is-active")})).catch(t)},a=document.querySelectorAll(".popup"),u=!1,i=function(e){e.classList.add("popup__opened"),s()},l=function(e){e&&(e.classList.remove("popup__opened"),d())},s=function(){u||(document.addEventListener("keydown",p),u=!0)},d=function(){document.removeEventListener("keydown",p),u=!1},p=function(e){if("Escape"===e.key){var t=document.querySelector(".popup__opened");l(t)}};a.forEach((function(e){e.addEventListener("click",(function(t){(t.target===e||t.target.classList.contains("popup__close"))&&l(e)}))}));var _,f=function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));o&&(t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass))},m=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));r&&(t.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent="")},y=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove(n.inactiveButtonClass)):(t.setAttribute("disabled","true"),t.classList.add(n.inactiveButtonClass))},v=function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector));n.forEach((function(n){m(e,n,t)}));var r=e.querySelector(t.submitButtonSelector);y(n,r,t)},h=document.forms.namedItem("edit_avatar"),S=document.forms.namedItem("edit_profile"),b=document.forms.namedItem("new_place"),q=document.querySelector(".popup_type_avatar"),E=document.querySelector(".popup_type_edit"),L=document.querySelector(".popup_type_image"),g=document.querySelector(".popup_type_new-card"),k=document.querySelector(".popup_type_delete_card"),C=document.querySelector(".profile__edit-button"),x=document.querySelector(".profile__add-button"),A=(k.querySelector(".popup__button-delete"),S.querySelector(".popup__input_type_name")),U=S.querySelector(".popup__input_type_description"),T=document.querySelector(".popup__input_type_avatar_url"),w=document.querySelector(".profile__title"),B=document.querySelector(".profile__description"),D=document.querySelector(".profile__image"),I=document.querySelector(".places__list"),P=document.querySelector(".popup__input_type_card-name"),N=document.querySelector(".popup__input_type_url"),O=L.querySelector(".popup__image"),j=L.querySelector(".popup__caption"),H=document.querySelector(".profile__image");D.addEventListener("click",(function(){i(q),v(h,F)})),C.addEventListener("click",(function(){i(E),v(S,F),J()})),x.addEventListener("click",(function(){i(g),v(b,F)}));var J=function(){A.value=w.textContent,U.value=B.textContent},M=function(e){if(e.target instanceof HTMLImageElement&&e.target.classList.contains("card__image")){var t=e.target.closest(".places__item").querySelector(".card__title").textContent;O.src=e.target.getAttribute("src"),O.alt=t,j.textContent=t,i(L)}};h.addEventListener("submit",(function(r){var o;r.preventDefault(),G(!0),(o=T.value,fetch("".concat(n.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:n.headers,body:JSON.stringify({avatar:o})}).then(e)).then((function(e){H.style.backgroundImage="url(".concat(e.avatar,")")})).then((function(){return l(q)})).catch(t).finally((function(){return G(!1)}))})),S.addEventListener("submit",(function(r){var o,c;r.preventDefault(),G(!0),(o=A.value,c=U.value,fetch("".concat(n.baseUrl,"/users/me"),{method:"PATCH",headers:n.headers,body:JSON.stringify({name:o,about:c})}).then(e)).then((function(e){w.textContent=e.name,B.textContent=e.about})).then((function(){return l(E)})).catch(t).finally((function(){return G(!1)}))})),b.addEventListener("submit",(function(a){var u,i;a.preventDefault(),G(!0),(u=P.value,i=N.value,fetch("".concat(n.baseUrl,"/cards"),{method:"POST",headers:n.headers,body:JSON.stringify({name:u,link:i,likes:0})}).then(e)).then((function(e){var t=r(e,o,c,M,_);I.prepend(t)})).then((function(){return b.reset()})).then((function(){return l(g)})).catch(t).finally((function(){return G(!1)}))}));var z,F={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},G=function(e){document.querySelectorAll(".popup__button").forEach((function(t){return t.textContent=e?"Сохранение...":"Сохранить"}))};Promise.all([fetch("".concat(n.baseUrl,"/users/me"),{headers:n.headers}).then(e),fetch("".concat(n.baseUrl,"/cards"),{headers:n.headers}).then(e)]).then((function(e){var t=e[0],n=e[1];_=t._id,w.textContent=t.name,B.textContent=t.about,H.style.backgroundImage="url(".concat(t.avatar,")"),function(e,t){e.forEach((function(e){var n=r(e,o,c,M,t);I.append(n)}))}(n,_)})).catch(t),z=F,Array.from(document.querySelectorAll(z.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),r=e.querySelector(t.submitButtonSelector);y(n,r,t),n.forEach((function(o){o.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?m(e,t,n):(f(e,t,t.validationMessage,n),""===t.value.trim()?f(e,t,t.dataset.error,n):t.validity.typeMismatch&&f(e,t,t.dataset.url,n))}(e,o,t),y(n,r,t)}))}))}(e,z)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQW1DWCxFQUFZcEQsY0FDcER1RCxFQUFTbUIsc0JBR1ZiLEVBQWtCQyxFQUFXQyxFQUFlUixHQUU1Q08sRUFBVWIsU0FBUSxTQUFDSSxHQUNsQkEsRUFBYXhDLGlCQUFpQixTQUFTLFlBbEVkLFNBQzFCdUMsRUFDQUMsRUFDQUUsR0FFS0YsRUFBYVcsU0FBU0MsTUF1QjFCTCxFQUFlUixFQUFhQyxFQUFjRSxJQXRCMUNKLEVBQ0NDLEVBQ0FDLEVBQ0FBLEVBQWF1RSxrQkFDYnJFLEdBRWlDLEtBQTlCRixFQUFhZ0QsTUFBTXdCLE9BQ3RCMUUsRUFDQ0MsRUFDQUMsRUFDQUEsRUFBYXlFLFFBQVE3SSxNQUNyQnNFLEdBRVNGLEVBQWFXLFNBQVMrRCxjQUNoQzVFLEVBQ0NDLEVBQ0FDLEVBQ0FBLEVBQWF5RSxRQUFRRSxJQUNyQnpFLEdBTUosQ0FxQ0cwRSxDQUFtQjdFLEVBQWFDLEVBQWNFLEdBQzlDTSxFQUFrQkMsRUFBV0MsRUFBZVIsRUFDN0MsR0FDRCxHQUNELENBVUUyRSxDQUFrQjlFLEVBQWFHLEVBQ2hDLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL2FwaS50cyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvY2FyZC50cyIsIndlYnBhY2s6Ly9tZXN0by1wcm9qZWN0LWZmLy4vc3JjL2NvbXBvbmVudHMvbW9kYWwudHMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vbWVzdG8tcHJvamVjdC1mZi8uL3NyYy9jb21wb25lbnRzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBmdW5jdGlvbiBjaGVja1Jlc3BvbnNlPFQ+KHJlczogUmVzcG9uc2UpOiBQcm9taXNlPFQ+IHtcclxuXHRpZiAocmVzLm9rKSB7XHJcblx0XHRyZXR1cm4gcmVzLmpzb24oKVxyXG5cdH1cclxuXHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoYNCe0YjQuNCx0LrQsDogJHtyZXMuc3RhdHVzfWApXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBjYXRjaEVycm9yID0gKGVycm9yOiBzdHJpbmcpOiB2b2lkID0+IGNvbnNvbGUubG9nKGVycm9yKVxyXG4iLCJpbXBvcnQgeyBDb25maWcgfSBmcm9tICcuLi90eXBlcy9nbG9iYWwuZCdcclxuaW1wb3J0IHsgY2hlY2tSZXNwb25zZSB9IGZyb20gJy4vdXRpbHMnXHJcblxyXG5jb25zdCBjb25maWc6IENvbmZpZyA9IHtcclxuXHRiYXNlVXJsOiAnaHR0cHM6Ly9ub21vcmVwYXJ0aWVzLmNvL3YxL3dmZi1jb2hvcnQtNScsXHJcblx0aGVhZGVyczoge1xyXG5cdFx0YXV0aG9yaXphdGlvbjogJ2YwMTlhNWRhLWM5OGYtNGM2ZS1iNGI5LWQ3ODkwYzgzOGFmYicsXHJcblx0XHQnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0VXNlckluZm8gPSAoKSA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuXHRcdGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ2V0SW5pdGlhbENhcmRzID0gKCkgPT4ge1xyXG5cdHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vY2FyZHNgLCB7XHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG5cdH0pLnRoZW4oY2hlY2tSZXNwb25zZSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXJQcm9maWxlID0gKG5hbWU6IHN0cmluZywgYWJvdXQ6IHN0cmluZykgPT4ge1xyXG5cdHJldHVybiBmZXRjaChgJHtjb25maWcuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcblx0XHRtZXRob2Q6ICdQQVRDSCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuXHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuXHRcdFx0bmFtZSxcclxuXHRcdFx0YWJvdXRcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcG9zdE5ld0NhcmQgPSAobmFtZTogc3RyaW5nLCBsaW5rOiBzdHJpbmcpID0+IHtcclxuXHRyZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L2NhcmRzYCwge1xyXG5cdFx0bWV0aG9kOiAnUE9TVCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVycyxcclxuXHRcdGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuXHRcdFx0bmFtZSxcclxuXHRcdFx0bGluayxcclxuXHRcdFx0bGlrZXM6IDBcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgbGlrZUNhcmQgPSAoXHJcblx0bGlrZUJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQsXHJcblx0Y2FyZElkOiBzdHJpbmcsXHJcblx0dXNlcklkOiBzdHJpbmdcclxuKSA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcblx0XHRtZXRob2Q6IGxpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdjYXJkX19saWtlLWJ1dHRvbl9pcy1hY3RpdmUnKVxyXG5cdFx0XHQ/ICdERUxFVEUnXHJcblx0XHRcdDogJ1BVVCcsXHJcblx0XHRoZWFkZXJzOiBjb25maWcuaGVhZGVyc1xyXG5cdH0pLnRoZW4oY2hlY2tSZXNwb25zZSlcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNhcmQgPSAoY2FyZEVsZW1lbnQ6IEhUTUxMSUVsZW1lbnQsIGNhcmRJZDogc3RyaW5nKSA9PiB7XHJcblx0cmV0dXJuIGZldGNoKGAke2NvbmZpZy5iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcblx0XHRtZXRob2Q6ICdERUxFVEUnLFxyXG5cdFx0aGVhZGVyczogY29uZmlnLmhlYWRlcnNcclxuXHR9KS50aGVuKGNoZWNrUmVzcG9uc2UpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCB1cGRhdGVBdmF0YXIgPSAoYXZhdGFyOiBzdHJpbmcpID0+IHtcclxuXHRyZXR1cm4gZmV0Y2goYCR7Y29uZmlnLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuXHRcdG1ldGhvZDogJ1BBVENIJyxcclxuXHRcdGhlYWRlcnM6IGNvbmZpZy5oZWFkZXJzLFxyXG5cdFx0Ym9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG5cdFx0XHRhdmF0YXJcclxuXHRcdH0pXHJcblx0fSkudGhlbihjaGVja1Jlc3BvbnNlKVxyXG59XHJcbiIsImltcG9ydCB7IENhcmQsIExpa2VzIH0gZnJvbSAnLi4vdHlwZXMvZ2xvYmFsJ1xyXG5pbXBvcnQgeyBkZWxldGVDYXJkLCBsaWtlQ2FyZCB9IGZyb20gJy4vYXBpJ1xyXG5pbXBvcnQgeyBjYXRjaEVycm9yIH0gZnJvbSAnLi91dGlscydcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVDYXJkID0gKFxyXG5cdGNhcmQ6IENhcmQsXHJcblx0aGFuZGxlRGVsZXRlQ2FyZDogKGNhcmRFbGVtZW50OiBIVE1MTElFbGVtZW50LCBjYXJkSWQ6IHN0cmluZykgPT4gdm9pZCxcclxuXHRoYW5kbGVMaWtlQ2FyZDogKFxyXG5cdFx0bGlrZUJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQsXHJcblx0XHRsaWtlc0NvdW50RWxlbWVudDogSFRNTFNwYW5FbGVtZW50LFxyXG5cdFx0Y2FyZElkOiBzdHJpbmcsXHJcblx0XHRjdXJyZW50VXNlcklkOiBzdHJpbmdcclxuXHQpID0+IHZvaWQsXHJcblx0b3BlbkltYWdlTW9kYWw6IChldnQ6IE1vdXNlRXZlbnQpID0+IHZvaWQsXHJcblx0Y3VycmVudFVzZXJJZDogc3RyaW5nXHJcbik6IEhUTUxMSUVsZW1lbnQgPT4ge1xyXG5cdGNvbnN0IGNhcmRUZW1wbGF0ZTogSFRNTFRlbXBsYXRlRWxlbWVudCA9XHJcblx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjY2FyZC10ZW1wbGF0ZScpXHJcblx0Y29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxyXG5cdFx0LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJylcclxuXHRcdC5jbG9uZU5vZGUodHJ1ZSkgYXMgSFRNTExJRWxlbWVudFxyXG5cdGNvbnN0IGNhcmRJbWFnZTogSFRNTEltYWdlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19pbWFnZScpXHJcblx0Y29uc3QgY2FyZFRpdGxlOiBIVE1MVGl0bGVFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3RpdGxlJylcclxuXHRjb25zdCBkZWxldGVCdXR0b246IEhUTUxCdXR0b25FbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHRcdCcuY2FyZF9fZGVsZXRlLWJ1dHRvbidcclxuXHQpXHJcblx0Y29uc3QgbGlrZUJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPVxyXG5cdFx0Y2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJylcclxuXHRjb25zdCBsaWtlc0NvdW50RWxlbWVudDogSFRNTFNwYW5FbGVtZW50ID0gbGlrZUJ1dHRvblxyXG5cdFx0LmNsb3Nlc3QoJy5jYXJkJylcclxuXHRcdC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1hbW91bnQnKVxyXG5cclxuXHRpZiAoY2FyZC5vd25lciAmJiBjYXJkLm93bmVyLl9pZCA9PT0gY3VycmVudFVzZXJJZCkge1xyXG5cdFx0ZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXHJcblx0XHRkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PlxyXG5cdFx0XHRoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBjYXJkLl9pZClcclxuXHRcdClcclxuXHR9IGVsc2Uge1xyXG5cdFx0ZGVsZXRlQnV0dG9uLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcclxuXHR9XHJcblxyXG5cdGNvbnN0IGlzTGlrZWRCeUN1cnJlbnRVc2VyID1cclxuXHRcdGNhcmQubGlrZXMgJiYgY2FyZC5saWtlcy5zb21lKGxpa2UgPT4gbGlrZS5faWQgPT09IGN1cnJlbnRVc2VySWQpXHJcblx0aWYgKGlzTGlrZWRCeUN1cnJlbnRVc2VyKSB7XHJcblx0XHRsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2UtYnV0dG9uX2lzLWFjdGl2ZScpXHJcblx0fVxyXG5cclxuXHRsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT5cclxuXHRcdGhhbmRsZUxpa2VDYXJkKGxpa2VCdXR0b24sIGxpa2VzQ291bnRFbGVtZW50LCBjYXJkLl9pZCwgY3VycmVudFVzZXJJZClcclxuXHQpXHJcblxyXG5cdGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiBvcGVuSW1hZ2VNb2RhbChldnQpKVxyXG5cclxuXHRjYXJkSW1hZ2Uuc3JjID0gY2FyZC5saW5rXHJcblx0Y2FyZEltYWdlLmFsdCA9IGNhcmQubmFtZVxyXG5cdGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGNhcmQubmFtZVxyXG5cdGxpa2VzQ291bnRFbGVtZW50LnRleHRDb250ZW50ID0gKFxyXG5cdFx0Y2FyZC5saWtlcyA/IGNhcmQubGlrZXMubGVuZ3RoIDogMFxyXG5cdCkudG9TdHJpbmcoKVxyXG5cclxuXHRyZXR1cm4gY2FyZEVsZW1lbnRcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGhhbmRsZURlbGV0ZUNhcmQgPSAoXHJcblx0Y2FyZEVsZW1lbnQ6IEhUTUxMSUVsZW1lbnQsXHJcblx0Y2FyZElkOiBzdHJpbmdcclxuKSA9PiB7XHJcblx0ZGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKVxyXG5cdFx0LnRoZW4oKCkgPT4gY2FyZEVsZW1lbnQucmVtb3ZlKCkpXHJcblx0XHQuY2F0Y2goY2F0Y2hFcnJvcilcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGhhbmRsZUxpa2VDYXJkID0gKFxyXG5cdGxpa2VCdXR0b246IEhUTUxCdXR0b25FbGVtZW50LFxyXG5cdGxpa2VzQ291bnRFbGVtZW50OiBIVE1MU3BhbkVsZW1lbnQsXHJcblx0Y2FyZElkOiBzdHJpbmcsXHJcblx0Y3VycmVudFVzZXJJZDogc3RyaW5nXHJcbikgPT4ge1xyXG5cdGxpa2VDYXJkKGxpa2VCdXR0b24sIGNhcmRJZCwgY3VycmVudFVzZXJJZClcclxuXHRcdC50aGVuKChkYXRhOiB7IGxpa2VzOiBMaWtlc1tdIH0pID0+IHtcclxuXHRcdFx0bGlrZXNDb3VudEVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLmxpa2VzLmxlbmd0aC50b1N0cmluZygpXHJcblx0XHRcdGxpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnY2FyZF9fbGlrZS1idXR0b25faXMtYWN0aXZlJylcclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goY2F0Y2hFcnJvcilcclxufVxyXG4iLCJjb25zdCBtb2RhbHM6IE5vZGVMaXN0T2Y8SFRNTERpdkVsZW1lbnQ+ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwJylcclxubGV0IGlzRXNjTGlzdGVuZXJBZGRlZDogYm9vbGVhbiA9IGZhbHNlXHJcblxyXG5leHBvcnQgY29uc3Qgb3Blbk1vZGFsID0gKG1vZGFsOiBIVE1MRGl2RWxlbWVudCkgPT4ge1xyXG5cdG1vZGFsLmNsYXNzTGlzdC5hZGQoJ3BvcHVwX19vcGVuZWQnKVxyXG5cdGFkZEVzY0xpc3RlbmVyKClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNsb3NlTW9kYWwgPSAobW9kYWw6IEhUTUxEaXZFbGVtZW50IHwgbnVsbCkgPT4ge1xyXG5cdGlmIChtb2RhbCkge1xyXG5cdFx0bW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfX29wZW5lZCcpXHJcblx0XHRyZW1vdmVFc2NMaXN0ZW5lcigpXHJcblx0fVxyXG59XHJcblxyXG5jb25zdCBhZGRFc2NMaXN0ZW5lciA9ICgpID0+IHtcclxuXHRpZiAoIWlzRXNjTGlzdGVuZXJBZGRlZCkge1xyXG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGNsb3NlTW9kYWxPbkVzYylcclxuXHRcdGlzRXNjTGlzdGVuZXJBZGRlZCA9IHRydWVcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IHJlbW92ZUVzY0xpc3RlbmVyID0gKCkgPT4ge1xyXG5cdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjbG9zZU1vZGFsT25Fc2MpXHJcblx0aXNFc2NMaXN0ZW5lckFkZGVkID0gZmFsc2VcclxufVxyXG5cclxuY29uc3QgY2xvc2VNb2RhbE9uRXNjID0gKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG5cdGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xyXG5cdFx0Y29uc3Qgb3BlbmVkTW9kYWw6IEhUTUxEaXZFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19vcGVuZWQnKVxyXG5cdFx0Y2xvc2VNb2RhbChvcGVuZWRNb2RhbClcclxuXHR9XHJcbn1cclxuXHJcbm1vZGFscy5mb3JFYWNoKG1vZGFsID0+IHtcclxuXHRtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2dCA9PiB7XHJcblx0XHRpZiAoXHJcblx0XHRcdGV2dC50YXJnZXQgPT09IG1vZGFsIHx8XHJcblx0XHRcdChldnQudGFyZ2V0IGFzIEhUTUxEaXZFbGVtZW50KS5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZScpXHJcblx0XHQpIHtcclxuXHRcdFx0Y2xvc2VNb2RhbChtb2RhbClcclxuXHRcdH1cclxuXHR9KVxyXG59KVxyXG4iLCJpbXBvcnQgeyBWYWxpZGF0aW9uU2V0dGluZ3MgfSBmcm9tICcuLi90eXBlcy9nbG9iYWwuZCdcclxuXHJcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKFxyXG5cdGZvcm1FbGVtZW50OiBIVE1MRm9ybUVsZW1lbnQsXHJcblx0aW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50LFxyXG5cdGVycm9yTWVzc2FnZTogc3RyaW5nLFxyXG5cdHNldHRpbmdzOiBWYWxpZGF0aW9uU2V0dGluZ3NcclxuKSA9PiB7XHJcblx0Y29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApXHJcblx0aWYgKGVycm9yRWxlbWVudCkge1xyXG5cdFx0aW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKVxyXG5cdFx0ZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlXHJcblx0XHRlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZChzZXR0aW5ncy5lcnJvckNsYXNzKVxyXG5cdH1cclxufVxyXG5cclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxGb3JtRWxlbWVudCxcclxuXHRpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQsXHJcblx0c2V0dGluZ3M6IFZhbGlkYXRpb25TZXR0aW5nc1xyXG4pID0+IHtcclxuXHRjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYClcclxuXHRpZiAoZXJyb3JFbGVtZW50KSB7XHJcblx0XHRpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3MpXHJcblx0XHRlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5lcnJvckNsYXNzKVxyXG5cdFx0ZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJydcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChcclxuXHRmb3JtRWxlbWVudDogSFRNTEZvcm1FbGVtZW50LFxyXG5cdGlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudCxcclxuXHRzZXR0aW5nczogVmFsaWRhdGlvblNldHRpbmdzXHJcbikgPT4ge1xyXG5cdGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcblx0XHRzaG93SW5wdXRFcnJvcihcclxuXHRcdFx0Zm9ybUVsZW1lbnQsXHJcblx0XHRcdGlucHV0RWxlbWVudCxcclxuXHRcdFx0aW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxyXG5cdFx0XHRzZXR0aW5nc1xyXG5cdFx0KVxyXG5cdFx0aWYgKGlucHV0RWxlbWVudC52YWx1ZS50cmltKCkgPT09ICcnKSB7XHJcblx0XHRcdHNob3dJbnB1dEVycm9yKFxyXG5cdFx0XHRcdGZvcm1FbGVtZW50LFxyXG5cdFx0XHRcdGlucHV0RWxlbWVudCxcclxuXHRcdFx0XHRpbnB1dEVsZW1lbnQuZGF0YXNldC5lcnJvcixcclxuXHRcdFx0XHRzZXR0aW5nc1xyXG5cdFx0XHQpXHJcblx0XHR9IGVsc2UgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS50eXBlTWlzbWF0Y2gpIHtcclxuXHRcdFx0c2hvd0lucHV0RXJyb3IoXHJcblx0XHRcdFx0Zm9ybUVsZW1lbnQsXHJcblx0XHRcdFx0aW5wdXRFbGVtZW50LFxyXG5cdFx0XHRcdGlucHV0RWxlbWVudC5kYXRhc2V0LnVybCxcclxuXHRcdFx0XHRzZXR0aW5nc1xyXG5cdFx0XHQpXHJcblx0XHR9XHJcblx0fSBlbHNlIHtcclxuXHRcdGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHNldHRpbmdzKVxyXG5cdH1cclxufVxyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdDogSFRNTElucHV0RWxlbWVudFtdKSA9PiB7XHJcblx0cmV0dXJuIGlucHV0TGlzdC5zb21lKGlucHV0RWxlbWVudCA9PiB7XHJcblx0XHRyZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG5cdH0pXHJcbn1cclxuXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKFxyXG5cdGlucHV0TGlzdDogSFRNTElucHV0RWxlbWVudFtdLFxyXG5cdGJ1dHRvbkVsZW1lbnQ6IEhUTUxCdXR0b25FbGVtZW50LFxyXG5cdHNldHRpbmdzOiBWYWxpZGF0aW9uU2V0dGluZ3NcclxuKSA9PiB7XHJcblx0aWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcblx0XHRidXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAndHJ1ZScpXHJcblx0XHRidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcylcclxuXHR9IGVsc2Uge1xyXG5cdFx0YnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcclxuXHRcdGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKVxyXG5cdH1cclxufVxyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoXHJcblx0Zm9ybUVsZW1lbnQ6IEhUTUxGb3JtRWxlbWVudCxcclxuXHRzZXR0aW5nczogVmFsaWRhdGlvblNldHRpbmdzXHJcbikgPT4ge1xyXG5cdGNvbnN0IGlucHV0TGlzdDogSFRNTElucHV0RWxlbWVudFtdID0gQXJyYXkuZnJvbShcclxuXHRcdGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcclxuXHQpXHJcblx0Y29uc3QgYnV0dG9uRWxlbWVudDogSFRNTEJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdFx0c2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuXHQpXHJcblxyXG5cdHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgc2V0dGluZ3MpXHJcblxyXG5cdGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQpID0+IHtcclxuXHRcdGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuXHRcdFx0Y2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHNldHRpbmdzKVxyXG5cdFx0XHR0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKVxyXG5cdFx0fSlcclxuXHR9KVxyXG59XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHNldHRpbmdzOiBWYWxpZGF0aW9uU2V0dGluZ3MpID0+IHtcclxuXHRjb25zdCBmb3JtTGlzdDogSFRNTEZvcm1FbGVtZW50W10gPSBBcnJheS5mcm9tKFxyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5mb3JtU2VsZWN0b3IpXHJcblx0KVxyXG5cdGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50OiBIVE1MRm9ybUVsZW1lbnQpID0+IHtcclxuXHRcdGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGV2dCA9PiB7XHJcblx0XHRcdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0XHR9KVxyXG5cdFx0c2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIHNldHRpbmdzKVxyXG5cdH0pXHJcbn1cclxuXHJcbmNvbnN0IGNsZWFyVmFsaWRhdGlvbiA9IChcclxuXHRmb3JtRWxlbWVudDogSFRNTEZvcm1FbGVtZW50LFxyXG5cdHNldHRpbmdzOiBWYWxpZGF0aW9uU2V0dGluZ3NcclxuKSA9PiB7XHJcblx0Y29uc3QgaW5wdXRMaXN0OiBIVE1MSW5wdXRFbGVtZW50W10gPSBBcnJheS5mcm9tKFxyXG5cdFx0Zm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZXR0aW5ncy5pbnB1dFNlbGVjdG9yKVxyXG5cdClcclxuXHRpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50KSA9PiB7XHJcblx0XHRoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBzZXR0aW5ncylcclxuXHR9KVxyXG5cclxuXHRjb25zdCBidXR0b25FbGVtZW50OiBIVE1MQnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XHRzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxyXG5cdClcclxuXHR0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIHNldHRpbmdzKVxyXG59XHJcblxyXG5leHBvcnQgeyBjbGVhclZhbGlkYXRpb24sIGVuYWJsZVZhbGlkYXRpb24gfVxyXG4iLCJpbXBvcnQgJy4uL3BhZ2VzL2luZGV4LmNzcydcclxuaW1wb3J0IHsgQ2FyZCwgVXNlckluZm9UeXBlIH0gZnJvbSAnLi4vdHlwZXMvZ2xvYmFsLmQnXHJcbmltcG9ydCB7XHJcblx0ZGVsZXRlQ2FyZCxcclxuXHRnZXRJbml0aWFsQ2FyZHMsXHJcblx0Z2V0VXNlckluZm8sXHJcblx0cG9zdE5ld0NhcmQsXHJcblx0dXBkYXRlQXZhdGFyLFxyXG5cdHVwZGF0ZVVzZXJQcm9maWxlXHJcbn0gZnJvbSAnLi9hcGknXHJcbmltcG9ydCB7IGNyZWF0ZUNhcmQsIGhhbmRsZURlbGV0ZUNhcmQsIGhhbmRsZUxpa2VDYXJkIH0gZnJvbSAnLi9jYXJkJ1xyXG5pbXBvcnQgeyBjbG9zZU1vZGFsLCBvcGVuTW9kYWwgfSBmcm9tICcuL21vZGFsJ1xyXG5pbXBvcnQgeyBjYXRjaEVycm9yIH0gZnJvbSAnLi91dGlscydcclxuaW1wb3J0IHsgY2xlYXJWYWxpZGF0aW9uLCBlbmFibGVWYWxpZGF0aW9uIH0gZnJvbSAnLi92YWxpZGF0aW9uJ1xyXG5cclxuY29uc3QgZWRpdEF2YXRhckZvcm06IEhUTUxGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zLm5hbWVkSXRlbSgnZWRpdF9hdmF0YXInKVxyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm06IEhUTUxGb3JtRWxlbWVudCA9XHJcblx0ZG9jdW1lbnQuZm9ybXMubmFtZWRJdGVtKCdlZGl0X3Byb2ZpbGUnKVxyXG5jb25zdCBuZXdQbGFjZUZvcm06IEhUTUxGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zLm5hbWVkSXRlbSgnbmV3X3BsYWNlJylcclxuY29uc3QgbW9kYWxFZGl0QXZhdGFyOiBIVE1MRGl2RWxlbWVudCA9XHJcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfYXZhdGFyJylcclxuY29uc3QgbW9kYWxFZGl0UHJvZmlsZTogSFRNTERpdkVsZW1lbnQgPVxyXG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2VkaXQnKVxyXG5jb25zdCBtb2RhbEltYWdlOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2ltYWdlJylcclxuY29uc3QgbW9kYWxOZXdDYXJkOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0Jy5wb3B1cF90eXBlX25ldy1jYXJkJ1xyXG4pXHJcbmNvbnN0IG1vZGFsRGVsZXRlQ29uZmlybWF0aW9uOiBIVE1MRGl2RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0Jy5wb3B1cF90eXBlX2RlbGV0ZV9jYXJkJ1xyXG4pXHJcbmNvbnN0IGVkaXRCdXR0b246IEhUTUxCdXR0b25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnByb2ZpbGVfX2VkaXQtYnV0dG9uJ1xyXG4pXHJcbmNvbnN0IGFkZEJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdCcucHJvZmlsZV9fYWRkLWJ1dHRvbidcclxuKVxyXG5jb25zdCBkZWxldGVCdXR0b25TdWJtaXQ6IEhUTUxCdXR0b25FbGVtZW50ID1cclxuXHRtb2RhbERlbGV0ZUNvbmZpcm1hdGlvbi5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbi1kZWxldGUnKVxyXG5jb25zdCBuYW1lSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX25hbWUnXHJcbilcclxuY29uc3Qgam9iSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uJ1xyXG4pXHJcbmNvbnN0IGF2YXRhcklucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnBvcHVwX19pbnB1dF90eXBlX2F2YXRhcl91cmwnXHJcbilcclxuY29uc3QgcHJvZmlsZU5hbWU6IEhUTUxUaXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdGl0bGUnKVxyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb246IEhUTUxQYXJhZ3JhcGhFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHQnLnByb2ZpbGVfX2Rlc2NyaXB0aW9uJ1xyXG4pXHJcbmNvbnN0IHByb2ZpbGVJbWFnZTogSFRNTEltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19pbWFnZScpXHJcbmNvbnN0IHBsYWNlc0xpc3Q6IEhUTUxVTGlzdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxhY2VzX19saXN0JylcclxuY29uc3QgY2FyZE5hbWVJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0Jy5wb3B1cF9faW5wdXRfdHlwZV9jYXJkLW5hbWUnXHJcbilcclxuY29uc3QgaW1hZ2VVcmxJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0Jy5wb3B1cF9faW5wdXRfdHlwZV91cmwnXHJcbilcclxuY29uc3QgcG9wdXBJbWFnZTogSFRNTEltYWdlRWxlbWVudCA9IG1vZGFsSW1hZ2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpXHJcbmNvbnN0IHBvcHVwQ2FwdGlvbjogSFRNTFBhcmFncmFwaEVsZW1lbnQgPVxyXG5cdG1vZGFsSW1hZ2UucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJylcclxuY29uc3QgcHJvZmlsZUF2YXRhcjogSFRNTERpdkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKVxyXG5sZXQgdXNlcklkOiBzdHJpbmcgfCBudWxsXHJcblxyXG5wcm9maWxlSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblx0b3Blbk1vZGFsKG1vZGFsRWRpdEF2YXRhcilcclxuXHRjbGVhclZhbGlkYXRpb24oZWRpdEF2YXRhckZvcm0sIGZvcm1TZXR0aW5ncylcclxufSlcclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblx0b3Blbk1vZGFsKG1vZGFsRWRpdFByb2ZpbGUpXHJcblx0Y2xlYXJWYWxpZGF0aW9uKGVkaXRQcm9maWxlRm9ybSwgZm9ybVNldHRpbmdzKVxyXG5cdHNldEZvcm1WYWx1ZXMoKVxyXG59KVxyXG5cclxuYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG5cdG9wZW5Nb2RhbChtb2RhbE5ld0NhcmQpXHJcblx0Y2xlYXJWYWxpZGF0aW9uKG5ld1BsYWNlRm9ybSwgZm9ybVNldHRpbmdzKVxyXG59KVxyXG5cclxuY29uc3Qgc2V0Rm9ybVZhbHVlcyA9ICgpID0+IHtcclxuXHRuYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudFxyXG5cdGpvYklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50XHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZUZvcm1TdWJtaXQgPSAoZXZ0OiBFdmVudCkgPT4ge1xyXG5cdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0cmVuZGVyTG9hZGluZyh0cnVlKVxyXG5cdHVwZGF0ZVVzZXJQcm9maWxlKG5hbWVJbnB1dC52YWx1ZSwgam9iSW5wdXQudmFsdWUpXHJcblx0XHQudGhlbigoZGF0YTogeyBuYW1lOiBzdHJpbmc7IGFib3V0OiBzdHJpbmcgfSkgPT4ge1xyXG5cdFx0XHRwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZVxyXG5cdFx0XHRwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0XHJcblx0XHR9KVxyXG5cdFx0LnRoZW4oKCkgPT4gY2xvc2VNb2RhbChtb2RhbEVkaXRQcm9maWxlKSlcclxuXHRcdC5jYXRjaChjYXRjaEVycm9yKVxyXG5cdFx0LmZpbmFsbHkoKCkgPT4gcmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZUF2YXRhckZvcm1TdWJtaXQgPSAoZXZ0OiBFdmVudCkgPT4ge1xyXG5cdGV2dC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0cmVuZGVyTG9hZGluZyh0cnVlKVxyXG5cdHVwZGF0ZUF2YXRhcihhdmF0YXJJbnB1dC52YWx1ZSlcclxuXHRcdC50aGVuKChkYXRhOiB7IGF2YXRhcjogc3RyaW5nIH0pID0+IHtcclxuXHRcdFx0cHJvZmlsZUF2YXRhci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7ZGF0YS5hdmF0YXJ9KWBcclxuXHRcdH0pXHJcblx0XHQudGhlbigoKSA9PiBjbG9zZU1vZGFsKG1vZGFsRWRpdEF2YXRhcikpXHJcblx0XHQuY2F0Y2goY2F0Y2hFcnJvcilcclxuXHRcdC5maW5hbGx5KCgpID0+IHJlbmRlckxvYWRpbmcoZmFsc2UpKVxyXG59XHJcblxyXG5jb25zdCBoYW5kbGVEZWxldGVDb25maXJtYXRpb24gPSAoXHJcblx0ZXZ0OiBFdmVudCxcclxuXHRjYXJkRWxlbWVudDogSFRNTExJRWxlbWVudCxcclxuXHRjYXJkSWQ6IHN0cmluZ1xyXG4pID0+IHtcclxuXHRldnQucHJldmVudERlZmF1bHQoKVxyXG5cdGRlbGV0ZUJ1dHRvblN1Ym1pdC50ZXh0Q29udGVudCA9ICfQo9C00LDQu9C10L3QuNC1Li4uJ1xyXG5cdGRlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGNhcmRJZClcclxuXHRcdC50aGVuKCgpID0+IGNsb3NlTW9kYWwobW9kYWxEZWxldGVDb25maXJtYXRpb24pKVxyXG5cdFx0LmNhdGNoKGNhdGNoRXJyb3IpXHJcbn1cclxuXHJcbmNvbnN0IG9wZW5JbWFnZU1vZGFsID0gKGV2dDogRXZlbnQpID0+IHtcclxuXHRpZiAoXHJcblx0XHRldnQudGFyZ2V0IGluc3RhbmNlb2YgSFRNTEltYWdlRWxlbWVudCAmJlxyXG5cdFx0ZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NhcmRfX2ltYWdlJylcclxuXHQpIHtcclxuXHRcdGNvbnN0IGNhcmRFbGVtZW50ID0gZXZ0LnRhcmdldC5jbG9zZXN0KCcucGxhY2VzX19pdGVtJylcclxuXHRcdGNvbnN0IGNhcmRUaXRsZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50XHJcblxyXG5cdFx0cG9wdXBJbWFnZS5zcmMgPSBldnQudGFyZ2V0LmdldEF0dHJpYnV0ZSgnc3JjJylcclxuXHRcdHBvcHVwSW1hZ2UuYWx0ID0gY2FyZFRpdGxlXHJcblx0XHRwb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBjYXJkVGl0bGVcclxuXHJcblx0XHRvcGVuTW9kYWwobW9kYWxJbWFnZSlcclxuXHR9XHJcbn1cclxuXHJcbmNvbnN0IGNyZWF0ZU5ld1BsYWNlID0gKGV2dDogRXZlbnQpID0+IHtcclxuXHRldnQucHJldmVudERlZmF1bHQoKVxyXG5cdHJlbmRlckxvYWRpbmcodHJ1ZSlcclxuXHRwb3N0TmV3Q2FyZChjYXJkTmFtZUlucHV0LnZhbHVlLCBpbWFnZVVybElucHV0LnZhbHVlKVxyXG5cdFx0LnRoZW4oKG5ld0NhcmQ6IENhcmQpID0+IHtcclxuXHRcdFx0Y29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKFxyXG5cdFx0XHRcdG5ld0NhcmQsXHJcblx0XHRcdFx0aGFuZGxlRGVsZXRlQ2FyZCxcclxuXHRcdFx0XHRoYW5kbGVMaWtlQ2FyZCxcclxuXHRcdFx0XHRvcGVuSW1hZ2VNb2RhbCxcclxuXHRcdFx0XHR1c2VySWRcclxuXHRcdFx0KSBhcyBIVE1MTElFbGVtZW50XHJcblxyXG5cdFx0XHRwbGFjZXNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpXHJcblx0XHR9KVxyXG5cdFx0LnRoZW4oKCkgPT4gbmV3UGxhY2VGb3JtLnJlc2V0KCkpXHJcblx0XHQudGhlbigoKSA9PiBjbG9zZU1vZGFsKG1vZGFsTmV3Q2FyZCkpXHJcblx0XHQuY2F0Y2goY2F0Y2hFcnJvcilcclxuXHRcdC5maW5hbGx5KCgpID0+IHJlbmRlckxvYWRpbmcoZmFsc2UpKVxyXG59XHJcblxyXG5lZGl0QXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KVxyXG5lZGl0UHJvZmlsZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlRm9ybVN1Ym1pdClcclxubmV3UGxhY2VGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGNyZWF0ZU5ld1BsYWNlKVxyXG5cclxuY29uc3QgZm9ybVNldHRpbmdzID0ge1xyXG5cdGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXHJcblx0aW5wdXRTZWxlY3RvcjogJy5wb3B1cF9faW5wdXQnLFxyXG5cdHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19idXR0b24nLFxyXG5cdGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fYnV0dG9uX2Rpc2FibGVkJyxcclxuXHRpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9faW5wdXRfdHlwZV9lcnJvcicsXHJcblx0ZXJyb3JDbGFzczogJ3BvcHVwX19lcnJvcl92aXNpYmxlJ1xyXG59XHJcblxyXG5jb25zdCByZW5kZXJDYXJkcyA9IChjYXJkczogQ2FyZFtdLCBjdXJyZW50VXNlcklkOiBzdHJpbmcpID0+IHtcclxuXHRjYXJkcy5mb3JFYWNoKChjYXJkOiBDYXJkKSA9PiB7XHJcblx0XHRjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoXHJcblx0XHRcdGNhcmQsXHJcblx0XHRcdGhhbmRsZURlbGV0ZUNhcmQsXHJcblx0XHRcdGhhbmRsZUxpa2VDYXJkLFxyXG5cdFx0XHRvcGVuSW1hZ2VNb2RhbCxcclxuXHRcdFx0Y3VycmVudFVzZXJJZFxyXG5cdFx0KSBhcyBIVE1MTElFbGVtZW50XHJcblx0XHRwbGFjZXNMaXN0LmFwcGVuZChjYXJkRWxlbWVudClcclxuXHR9KVxyXG59XHJcblxyXG5jb25zdCByZW5kZXJMb2FkaW5nID0gKGlzTG9hZGluZzogYm9vbGVhbikgPT4ge1xyXG5cdGNvbnN0IHN1Ym1pdEJ1dHRvbjogTm9kZUxpc3RPZjxIVE1MQnV0dG9uRWxlbWVudD4gPVxyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19idXR0b24nKVxyXG5cdHN1Ym1pdEJ1dHRvbi5mb3JFYWNoKFxyXG5cdFx0KGJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQpID0+XHJcblx0XHRcdChidXR0b24udGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyAn0KHQvtGF0YDQsNC90LXQvdC40LUuLi4nIDogJ9Ch0L7RhdGA0LDQvdC40YLRjCcpXHJcblx0KVxyXG59XHJcblxyXG5Qcm9taXNlLmFsbChbZ2V0VXNlckluZm8oKSwgZ2V0SW5pdGlhbENhcmRzKCldKVxyXG5cdC50aGVuKChbdXNlckRhdGEsIGNhcmRzXTogW1VzZXJJbmZvVHlwZSwgQ2FyZFtdXSkgPT4ge1xyXG5cdFx0dXNlcklkID0gdXNlckRhdGEuX2lkXHJcblx0XHRwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IHVzZXJEYXRhLm5hbWVcclxuXHRcdHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0XHJcblx0XHRwcm9maWxlQXZhdGFyLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt1c2VyRGF0YS5hdmF0YXJ9KWBcclxuXHJcblx0XHRyZW5kZXJDYXJkcyhjYXJkcywgdXNlcklkKVxyXG5cdH0pXHJcblx0LmNhdGNoKGNhdGNoRXJyb3IpXHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKGZvcm1TZXR0aW5ncylcclxuXHJcbmV4cG9ydCB7XHJcblx0bW9kYWxEZWxldGVDb25maXJtYXRpb24sXHJcblx0bW9kYWxOZXdDYXJkLFxyXG5cdG5ld1BsYWNlRm9ybSxcclxuXHRwbGFjZXNMaXN0LFxyXG5cdHByb2ZpbGVEZXNjcmlwdGlvbixcclxuXHRwcm9maWxlTmFtZVxyXG59XHJcbiJdLCJuYW1lcyI6WyJjaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImVycm9yIiwiY29uc29sZSIsImxvZyIsImNvbmZpZyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImNyZWF0ZUNhcmQiLCJjYXJkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImhhbmRsZUxpa2VDYXJkIiwib3BlbkltYWdlTW9kYWwiLCJjdXJyZW50VXNlcklkIiwiY2FyZEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwiZGVsZXRlQnV0dG9uIiwibGlrZUJ1dHRvbiIsImxpa2VzQ291bnRFbGVtZW50IiwiY2xvc2VzdCIsIm93bmVyIiwiX2lkIiwic3R5bGUiLCJkaXNwbGF5IiwiYWRkRXZlbnRMaXN0ZW5lciIsImxpa2VzIiwic29tZSIsImxpa2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJldnQiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsInRleHRDb250ZW50IiwibGVuZ3RoIiwidG9TdHJpbmciLCJjYXJkSWQiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJyZW1vdmUiLCJjYXRjaCIsInVzZXJJZCIsImNvbnRhaW5zIiwibGlrZUNhcmQiLCJkYXRhIiwidG9nZ2xlIiwibW9kYWxzIiwicXVlcnlTZWxlY3RvckFsbCIsImlzRXNjTGlzdGVuZXJBZGRlZCIsIm9wZW5Nb2RhbCIsIm1vZGFsIiwiYWRkRXNjTGlzdGVuZXIiLCJyZW1vdmVFc2NMaXN0ZW5lciIsImNsb3NlTW9kYWxPbkVzYyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJvcGVuZWRNb2RhbCIsImZvckVhY2giLCJ0YXJnZXQiLCJzaG93SW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwic2V0dGluZ3MiLCJlcnJvckVsZW1lbnQiLCJpZCIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwic2V0QXR0cmlidXRlIiwiY2xlYXJWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiZWRpdEF2YXRhckZvcm0iLCJmb3JtcyIsIm5hbWVkSXRlbSIsImVkaXRQcm9maWxlRm9ybSIsIm5ld1BsYWNlRm9ybSIsIm1vZGFsRWRpdEF2YXRhciIsIm1vZGFsRWRpdFByb2ZpbGUiLCJtb2RhbEltYWdlIiwibW9kYWxOZXdDYXJkIiwibW9kYWxEZWxldGVDb25maXJtYXRpb24iLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJhdmF0YXJJbnB1dCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUltYWdlIiwicGxhY2VzTGlzdCIsImNhcmROYW1lSW5wdXQiLCJpbWFnZVVybElucHV0IiwicG9wdXBJbWFnZSIsInBvcHVwQ2FwdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJmb3JtU2V0dGluZ3MiLCJzZXRGb3JtVmFsdWVzIiwidmFsdWUiLCJIVE1MSW1hZ2VFbGVtZW50IiwiZ2V0QXR0cmlidXRlIiwiYXZhdGFyIiwicHJldmVudERlZmF1bHQiLCJyZW5kZXJMb2FkaW5nIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJmaW5hbGx5IiwiYWJvdXQiLCJuZXdDYXJkIiwicHJlcGVuZCIsInJlc2V0IiwiZm9ybVNlbGVjdG9yIiwiaXNMb2FkaW5nIiwiYnV0dG9uIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkcyIsImFwcGVuZCIsInJlbmRlckNhcmRzIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJ0cmltIiwiZGF0YXNldCIsInR5cGVNaXNtYXRjaCIsInVybCIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNldEV2ZW50TGlzdGVuZXJzIl0sInNvdXJjZVJvb3QiOiIifQ==